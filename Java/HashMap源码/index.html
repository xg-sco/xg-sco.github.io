

<!DOCTYPE html>
<html lang="zh-CN" >



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/smile.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#96c0d3cc">
  <meta name="author" content="肉豆蔻吖">
  <meta name="keywords" content="">
  
    <meta name="description" content="图解HashMap-常见问题  HashMap底层数据结构是什么样的 HashMap的操作: 插入、删除、查询过程 HashMap的Hash值计算过程 HashMap的数组大小为什么初始为16 HashMap为什么要扩容和扩容过程 HashMap是否线程安全和其原因   Node数组长度默认是16  当节点个数大于64, 并且链表长度大于8时, 链表结构将升级为红黑树 HashMap底层数据结构:">
<meta property="og:type" content="article">
<meta property="og:title" content="HashMap源码">
<meta property="og:url" content="https://xiamu.icu/Java/HashMap%E6%BA%90%E7%A0%81/index.html">
<meta property="og:site_name" content="肉豆蔻吖">
<meta property="og:description" content="图解HashMap-常见问题  HashMap底层数据结构是什么样的 HashMap的操作: 插入、删除、查询过程 HashMap的Hash值计算过程 HashMap的数组大小为什么初始为16 HashMap为什么要扩容和扩容过程 HashMap是否线程安全和其原因   Node数组长度默认是16  当节点个数大于64, 并且链表长度大于8时, 链表结构将升级为红黑树 HashMap底层数据结构:">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xiamu.icu/assets/2023-12-19-10-28-10.png">
<meta property="article:published_time" content="2023-12-18T11:47:05.000Z">
<meta property="article:modified_time" content="2024-08-01T02:34:18.864Z">
<meta property="article:author" content="肉豆蔻吖">
<meta property="article:tag" content="Java">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://xiamu.icu/assets/2023-12-19-10-28-10.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>HashMap源码 - 肉豆蔻吖</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  



  
<link rel="stylesheet" href="/css/custom.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"xiamu.icu","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>肉豆蔻吖</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/bg.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="HashMap源码"></span>
          
        </div>

        
          
  <div class="mt-3">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-author" aria-hidden="true"></i>
        肉豆蔻吖
      </span>
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-12-18 11:47" pubdate>
          2023年12月18日 中午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          63k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          527 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">HashMap源码</h1>
            
            
              <div class="markdown-body">
                
                <p>图解HashMap-常见问题</p>
<ul>
<li>HashMap底层数据结构是什么样的</li>
<li>HashMap的操作: 插入、删除、查询过程</li>
<li>HashMap的Hash值计算过程</li>
<li>HashMap的数组大小为什么初始为16</li>
<li>HashMap为什么要扩容和扩容过程</li>
<li>HashMap是否线程安全和其原因</li>
</ul>
<hr>
<p>Node数组长度默认是16</p>
<p><img src="/assets/2023-12-19-10-28-10.png" srcset="/img/loading.gif" lazyload></p>
<p>当节点个数大于64, 并且链表长度大于8时, 链表结构将升级为红黑树</p>
<p>HashMap底层数据结构: 数组 + 链表 + 红黑树</p>
<p>Hash碰撞是通过hash算法计算出来的hash值相同, 桶数组Node的索引也想相同, 最后插入到散链表中, 链表越来越长</p>
<p>源码解析:<br>几个常量<br>缺省 &#x3D;&gt; default &#x3D;&gt; 默认</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * The default initial capacity - MUST be a power of two.</span><br><span class="hljs-comment"> * 缺省table大小</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">DEFAULT_INITIAL_CAPACITY</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">4</span>; <span class="hljs-comment">// aka 16</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * The maximum capacity, used if a higher value is implicitly specified</span><br><span class="hljs-comment"> * by either of the constructors with arguments.</span><br><span class="hljs-comment"> * MUST be a power of two &lt;= 1&lt;&lt;30.</span><br><span class="hljs-comment"> * table最大长度</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MAXIMUM_CAPACITY</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">30</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * The load factor used when none specified in constructor.</span><br><span class="hljs-comment"> * 缺省负载因子</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">float</span> <span class="hljs-variable">DEFAULT_LOAD_FACTOR</span> <span class="hljs-operator">=</span> <span class="hljs-number">0.75f</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * The bin count threshold for using a tree rather than list for a</span><br><span class="hljs-comment"> * bin.  Bins are converted to trees when adding an element to a</span><br><span class="hljs-comment"> * bin with at least this many nodes. The value must be greater</span><br><span class="hljs-comment"> * than 2 and should be at least 8 to mesh with assumptions in</span><br><span class="hljs-comment"> * tree removal about conversion back to plain bins upon</span><br><span class="hljs-comment"> * shrinkage.</span><br><span class="hljs-comment"> * 树化阈值 , 超过8大小就会升级成树结构</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">TREEIFY_THRESHOLD</span> <span class="hljs-operator">=</span> <span class="hljs-number">8</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * The bin count threshold for untreeifying a (split) bin during a</span><br><span class="hljs-comment"> * resize operation. Should be less than TREEIFY_THRESHOLD, and at</span><br><span class="hljs-comment"> * most 6 to mesh with shrinkage detection under removal.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-comment">// 树降级成为链表的阈值, 链表的个数小于6的时候, 会从红黑树的结构转变成链表的结构</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">UNTREEIFY_THRESHOLD</span> <span class="hljs-operator">=</span> <span class="hljs-number">6</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * The smallest table capacity for which bins may be treeified.</span><br><span class="hljs-comment"> * (Otherwise the table is resized if too many nodes in a bin.)</span><br><span class="hljs-comment"> * Should be at least 4 * TREEIFY_THRESHOLD to avoid conflicts</span><br><span class="hljs-comment"> * between resizing and treeification thresholds.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-comment">// 树化的另一个参数, 当哈希表中的所有元素个数超过64时, 并且链表长度超过8, 才会允许树化</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MIN_TREEIFY_CAPACITY</span> <span class="hljs-operator">=</span> <span class="hljs-number">64</span>;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Basic hash bin node, used for most entries.  (See below for</span><br><span class="hljs-comment"> * TreeNode subclass, and in LinkedHashMap for its Entry subclass.)</span><br><span class="hljs-comment"> */</span><br><span class="hljs-comment">// Node的数据结构</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Node</span>&lt;K,V&gt; <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Map</span>.Entry&lt;K,V&gt; &#123;<br>    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> hash;<br>    <span class="hljs-keyword">final</span> K key;<br>    V value;<br>    Node&lt;K,V&gt; next;<br><br>    Node(<span class="hljs-type">int</span> hash, K key, V value, Node&lt;K,V&gt; next) &#123;<br>        <span class="hljs-built_in">this</span>.hash = hash;<br>        <span class="hljs-built_in">this</span>.key = key;<br>        <span class="hljs-built_in">this</span>.value = value;<br>        <span class="hljs-built_in">this</span>.next = next;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> K <span class="hljs-title function_">getKey</span><span class="hljs-params">()</span>        &#123; <span class="hljs-keyword">return</span> key; &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> V <span class="hljs-title function_">getValue</span><span class="hljs-params">()</span>      &#123; <span class="hljs-keyword">return</span> value; &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123; <span class="hljs-keyword">return</span> key + <span class="hljs-string">&quot;=&quot;</span> + value; &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hashCode</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> V <span class="hljs-title function_">setValue</span><span class="hljs-params">(V newValue)</span> &#123;<br>        <span class="hljs-type">V</span> <span class="hljs-variable">oldValue</span> <span class="hljs-operator">=</span> value;<br>        value = newValue;<br>        <span class="hljs-keyword">return</span> oldValue;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">equals</span><span class="hljs-params">(Object o)</span> &#123;<br>        <span class="hljs-keyword">if</span> (o == <span class="hljs-built_in">this</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">if</span> (o <span class="hljs-keyword">instanceof</span> Map.Entry) &#123;<br>            Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;<br>            <span class="hljs-keyword">if</span> (Objects.equals(key, e.getKey()) &amp;&amp;<br>                Objects.equals(value, e.getValue()))<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br></pre></td><td class="code"><pre><code class="hljs java">    <span class="hljs-comment">/* ---------------- Static utilities -------------- */</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Computes key.hashCode() and spreads (XORs) higher bits of hash</span><br><span class="hljs-comment"> * to lower.  Because the table uses power-of-two masking, sets of</span><br><span class="hljs-comment"> * hashes that vary only in bits above the current mask will</span><br><span class="hljs-comment"> * always collide. (Among known examples are sets of Float keys</span><br><span class="hljs-comment"> * holding consecutive whole numbers in small tables.)  So we</span><br><span class="hljs-comment"> * apply a transform that spreads the impact of higher bits</span><br><span class="hljs-comment"> * downward. There is a tradeoff between speed, utility, and</span><br><span class="hljs-comment"> * quality of bit-spreading. Because many common sets of hashes</span><br><span class="hljs-comment"> * are already reasonably distributed (so don&#x27;t benefit from</span><br><span class="hljs-comment"> * spreading), and because we use trees to handle large sets of</span><br><span class="hljs-comment"> * collisions in bins, we just XOR some shifted bits in the</span><br><span class="hljs-comment"> * cheapest possible way to reduce systematic lossage, as well as</span><br><span class="hljs-comment"> * to incorporate impact of the highest bits that would otherwise</span><br><span class="hljs-comment"> * never be used in index calculations because of table bounds.</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * 作用: 让key的hash值的高16位也参与路由运算</span><br><span class="hljs-comment"> * 异或: 相同则返回0, 不同返回1</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * h = 0b 0010 0101 1010 1100 0011 1111 0010 1110</span><br><span class="hljs-comment"> * 0b 0010 0101 1010 1100 0011 1111 0010 1110</span><br><span class="hljs-comment"> * ^</span><br><span class="hljs-comment"> * 0b 0000 0000 0000 0000 0010 0101 1010 1100</span><br><span class="hljs-comment"> * =</span><br><span class="hljs-comment"> * 0010 0101 1010 1100 0001 1010 1000 0010</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">hash</span><span class="hljs-params">(Object key)</span> &#123;<br>    <span class="hljs-type">int</span> h;<br>    <span class="hljs-keyword">return</span> (key == <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : (h = key.hashCode()) ^ (h &gt;&gt;&gt; <span class="hljs-number">16</span>);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns x&#x27;s Class if it is of the form &quot;class C implements</span><br><span class="hljs-comment"> * Comparable&lt;C&gt;&quot;, else null.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">static</span> Class&lt;?&gt; comparableClassFor(Object x) &#123;<br>    <span class="hljs-keyword">if</span> (x <span class="hljs-keyword">instanceof</span> Comparable) &#123;<br>        Class&lt;?&gt; c; Type[] ts, as; Type t; ParameterizedType p;<br>        <span class="hljs-keyword">if</span> ((c = x.getClass()) == String.class) <span class="hljs-comment">// bypass checks</span><br>            <span class="hljs-keyword">return</span> c;<br>        <span class="hljs-keyword">if</span> ((ts = c.getGenericInterfaces()) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; ts.length; ++i) &#123;<br>                <span class="hljs-keyword">if</span> (((t = ts[i]) <span class="hljs-keyword">instanceof</span> ParameterizedType) &amp;&amp;<br>                    ((p = (ParameterizedType)t).getRawType() ==<br>                     Comparable.class) &amp;&amp;<br>                    (as = p.getActualTypeArguments()) != <span class="hljs-literal">null</span> &amp;&amp;<br>                    as.length == <span class="hljs-number">1</span> &amp;&amp; as[<span class="hljs-number">0</span>] == c) <span class="hljs-comment">// type arg is c</span><br>                    <span class="hljs-keyword">return</span> c;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns k.compareTo(x) if x matches kc (k&#x27;s screened comparable</span><br><span class="hljs-comment"> * class), else 0.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span> <span class="hljs-comment">// for cast to Comparable</span><br><span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">compareComparables</span><span class="hljs-params">(Class&lt;?&gt; kc, Object k, Object x)</span> &#123;<br>    <span class="hljs-keyword">return</span> (x == <span class="hljs-literal">null</span> || x.getClass() != kc ? <span class="hljs-number">0</span> :<br>            ((Comparable)k).compareTo(x));<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns a power of two size for the given target capacity.</span><br><span class="hljs-comment"> * 作用: 返回一个大于等于当前cap的一个数字, 并且这个数字一定是2的次方数</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * cap = 10</span><br><span class="hljs-comment"> * n = 9</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * 0b1001 | 0b0100 = 0b1101</span><br><span class="hljs-comment"> * 0b1101 | 0b0011 = 0b1111 </span><br><span class="hljs-comment"> * 0b1111 | 0b0000 = 0b1111</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * 0b1111 = 15</span><br><span class="hljs-comment"> * return 15 + 1</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * cap = 16</span><br><span class="hljs-comment"> * n = 16</span><br><span class="hljs-comment"> * 0b10000 | 0b01000 = 0b11000</span><br><span class="hljs-comment"> * 0b11000 | 0b00110 = 0b11110 </span><br><span class="hljs-comment"> * 0b11110 | 0b00001 = 0b11111 </span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * 0b11111 = 31</span><br><span class="hljs-comment"> * return 31 + 1</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * 0001 1101 1100 =&gt; 0001 1111 1111 + 1 =&gt; 0010 0000 0000 =&gt; 32 </span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">tableSizeFor</span><span class="hljs-params">(<span class="hljs-type">int</span> cap)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">n</span> <span class="hljs-operator">=</span> cap - <span class="hljs-number">1</span>;<br>    n |= n &gt;&gt;&gt; <span class="hljs-number">1</span>;<br>    n |= n &gt;&gt;&gt; <span class="hljs-number">2</span>;<br>    n |= n &gt;&gt;&gt; <span class="hljs-number">4</span>;<br>    n |= n &gt;&gt;&gt; <span class="hljs-number">8</span>;<br>    n |= n &gt;&gt;&gt; <span class="hljs-number">16</span>;<br>    <span class="hljs-keyword">return</span> (n &lt; <span class="hljs-number">0</span>) ? <span class="hljs-number">1</span> : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-comment">/* ---------------- Fields -------------- */</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * The table, initialized on first use, and resized as</span><br><span class="hljs-comment"> * necessary. When allocated, length is always a power of two.</span><br><span class="hljs-comment"> * (We also tolerate length zero in some operations to allow</span><br><span class="hljs-comment"> * bootstrapping mechanics that are currently not needed.)</span><br><span class="hljs-comment"> * 哈希表</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * 什么时候初始化? </span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">transient</span> Node&lt;K,V&gt;[] table;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Holds cached entrySet(). Note that AbstractMap fields are used</span><br><span class="hljs-comment"> * for keySet() and values().</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">transient</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * The number of key-value mappings contained in this map.</span><br><span class="hljs-comment"> * 当前哈希表中元素个数</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">transient</span> <span class="hljs-type">int</span> size;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * The number of times this HashMap has been structurally modified</span><br><span class="hljs-comment"> * Structural modifications are those that change the number of mappings in</span><br><span class="hljs-comment"> * the HashMap or otherwise modify its internal structure (e.g.,</span><br><span class="hljs-comment"> * rehash).  This field is used to make iterators on Collection-views of</span><br><span class="hljs-comment"> * the HashMap fail-fast.  (See ConcurrentModificationException).</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * 当前哈希表结构修改次数, 每次添加或者删除的时候, modCount+1</span><br><span class="hljs-comment"> * 替换Node的时候, modCount不会发生变化</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">transient</span> <span class="hljs-type">int</span> modCount;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * The next size value at which to resize (capacity * load factor).</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 扩容阈值, 当你的哈希表中的元素超过阈值时, 触发扩容</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@serial</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-comment">// (The javadoc description is true upon serialization.</span><br><span class="hljs-comment">// Additionally, if the table array has not been allocated, this</span><br><span class="hljs-comment">// field holds the initial array capacity, or zero signifying</span><br><span class="hljs-comment">// DEFAULT_INITIAL_CAPACITY.)</span><br><span class="hljs-type">int</span> threshold;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * The load factor for the hash table.</span><br><span class="hljs-comment"> * 负载因子</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * threshold = capacity * loadFactor</span><br><span class="hljs-comment"> * </span><br><span class="hljs-comment"> * <span class="hljs-doctag">@serial</span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">final</span> <span class="hljs-type">float</span> loadFactor;<br><br><span class="hljs-comment">/* ---------------- Public operations -------------- */</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Constructs an empty &lt;tt&gt;HashMap&lt;/tt&gt; with the specified initial</span><br><span class="hljs-comment"> * capacity and load factor.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>  initialCapacity the initial capacity</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>  loadFactor      the load factor</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> IllegalArgumentException if the initial capacity is negative</span><br><span class="hljs-comment"> *         or the load factor is nonpositive</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">HashMap</span><span class="hljs-params">(<span class="hljs-type">int</span> initialCapacity, <span class="hljs-type">float</span> loadFactor)</span> &#123;<br>    <span class="hljs-comment">// 其实就是做了一些校验</span><br>    <span class="hljs-comment">// capacity必须是大于0, 最大值也就是MAX_CAP</span><br>    <span class="hljs-keyword">if</span> (initialCapacity &lt; <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;Illegal initial capacity: &quot;</span> +<br>                                           initialCapacity);<br>    <span class="hljs-keyword">if</span> (initialCapacity &gt; MAXIMUM_CAPACITY)<br>        initialCapacity = MAXIMUM_CAPACITY;<br><br>    <span class="hljs-comment">// loadFactor必须大于0</span><br>    <span class="hljs-keyword">if</span> (loadFactor &lt;= <span class="hljs-number">0</span> || Float.isNaN(loadFactor))<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalArgumentException</span>(<span class="hljs-string">&quot;Illegal load factor: &quot;</span> +<br>                                           loadFactor);<br><br>    <span class="hljs-built_in">this</span>.loadFactor = loadFactor;<br>    <span class="hljs-comment">// 控制initialCapacity必须是2的整数倍</span><br>    <span class="hljs-built_in">this</span>.threshold = tableSizeFor(initialCapacity);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Constructs an empty &lt;tt&gt;HashMap&lt;/tt&gt; with the specified initial</span><br><span class="hljs-comment"> * capacity and the default load factor (0.75).</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>  initialCapacity the initial capacity.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> IllegalArgumentException if the initial capacity is negative.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">HashMap</span><span class="hljs-params">(<span class="hljs-type">int</span> initialCapacity)</span> &#123;<br>    <span class="hljs-built_in">this</span>(initialCapacity, DEFAULT_LOAD_FACTOR);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Constructs an empty &lt;tt&gt;HashMap&lt;/tt&gt; with the default initial capacity</span><br><span class="hljs-comment"> * (16) and the default load factor (0.75).</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">HashMap</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-built_in">this</span>.loadFactor = DEFAULT_LOAD_FACTOR; <span class="hljs-comment">// all other fields defaulted</span><br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Constructs a new &lt;tt&gt;HashMap&lt;/tt&gt; with the same mappings as the</span><br><span class="hljs-comment"> * specified &lt;tt&gt;Map&lt;/tt&gt;.  The &lt;tt&gt;HashMap&lt;/tt&gt; is created with</span><br><span class="hljs-comment"> * default load factor (0.75) and an initial capacity sufficient to</span><br><span class="hljs-comment"> * hold the mappings in the specified &lt;tt&gt;Map&lt;/tt&gt;.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>   m the map whose mappings are to be placed in this map</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span>  NullPointerException if the specified map is null</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_">HashMap</span><span class="hljs-params">(Map&lt;? extends K, ? extends V&gt; m)</span> &#123;<br>    <span class="hljs-built_in">this</span>.loadFactor = DEFAULT_LOAD_FACTOR;<br>    putMapEntries(m, <span class="hljs-literal">false</span>);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Implements Map.putAll and Map constructor</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> m the map</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> evict false when initially constructing this map, else</span><br><span class="hljs-comment"> * true (relayed to method afterNodeInsertion).</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">putMapEntries</span><span class="hljs-params">(Map&lt;? extends K, ? extends V&gt; m, <span class="hljs-type">boolean</span> evict)</span> &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> m.size();<br>    <span class="hljs-keyword">if</span> (s &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">if</span> (table == <span class="hljs-literal">null</span>) &#123; <span class="hljs-comment">// pre-size</span><br>            <span class="hljs-type">float</span> <span class="hljs-variable">ft</span> <span class="hljs-operator">=</span> ((<span class="hljs-type">float</span>)s / loadFactor) + <span class="hljs-number">1.0F</span>;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">t</span> <span class="hljs-operator">=</span> ((ft &lt; (<span class="hljs-type">float</span>)MAXIMUM_CAPACITY) ?<br>                     (<span class="hljs-type">int</span>)ft : MAXIMUM_CAPACITY);<br>            <span class="hljs-keyword">if</span> (t &gt; threshold)<br>                threshold = tableSizeFor(t);<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (s &gt; threshold)<br>            resize();<br>        <span class="hljs-keyword">for</span> (Map.Entry&lt;? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">K</span>, ? <span class="hljs-keyword">extends</span> <span class="hljs-title class_">V</span>&gt; e : m.entrySet()) &#123;<br>            <span class="hljs-type">K</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> e.getKey();<br>            <span class="hljs-type">V</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> e.getValue();<br>            putVal(hash(key), key, value, <span class="hljs-literal">false</span>, evict);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns the number of key-value mappings in this map.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> the number of key-value mappings in this map</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> size;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns &lt;tt&gt;true&lt;/tt&gt; if this map contains no key-value mappings.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &lt;tt&gt;true&lt;/tt&gt; if this map contains no key-value mappings</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isEmpty</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> size == <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns the value to which the specified key is mapped,</span><br><span class="hljs-comment"> * or &#123;<span class="hljs-doctag">@code</span> null&#125; if this map contains no mapping for the key.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * &lt;p&gt;More formally, if this map contains a mapping from a key</span><br><span class="hljs-comment"> * &#123;<span class="hljs-doctag">@code</span> k&#125; to a value &#123;<span class="hljs-doctag">@code</span> v&#125; such that &#123;<span class="hljs-doctag">@code</span> (key==null ? k==null :</span><br><span class="hljs-comment"> * key.equals(k))&#125;, then this method returns &#123;<span class="hljs-doctag">@code</span> v&#125;; otherwise</span><br><span class="hljs-comment"> * it returns &#123;<span class="hljs-doctag">@code</span> null&#125;.  (There can be at most one such mapping.)</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * &lt;p&gt;A return value of &#123;<span class="hljs-doctag">@code</span> null&#125; does not &lt;i&gt;necessarily&lt;/i&gt;</span><br><span class="hljs-comment"> * indicate that the map contains no mapping for the key; it&#x27;s also</span><br><span class="hljs-comment"> * possible that the map explicitly maps the key to &#123;<span class="hljs-doctag">@code</span> null&#125;.</span><br><span class="hljs-comment"> * The &#123;<span class="hljs-doctag">@link</span> #containsKey containsKey&#125; operation may be used to</span><br><span class="hljs-comment"> * distinguish these two cases.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@see</span> #put(Object, Object)</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> V <span class="hljs-title function_">get</span><span class="hljs-params">(Object key)</span> &#123;<br>    Node&lt;K,V&gt; e;<br>    <span class="hljs-keyword">return</span> (e = getNode(hash(key), key)) == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : e.value;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Implements Map.get and related methods</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> hash hash for key</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> key the key</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> the node, or null if none</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">final</span> Node&lt;K,V&gt; <span class="hljs-title function_">getNode</span><span class="hljs-params">(<span class="hljs-type">int</span> hash, Object key)</span> &#123;<br>    <span class="hljs-comment">// tab: 引用当前hashMap的散列表</span><br>    <span class="hljs-comment">// first: 桶位中的头元素</span><br>    <span class="hljs-comment">// e: 临时node元素</span><br>    <span class="hljs-comment">// n: table数组长度</span><br>    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; <span class="hljs-type">int</span> n; K k;<br><br>    <br>    <span class="hljs-keyword">if</span> ((tab = table) != <span class="hljs-literal">null</span> &amp;&amp; (n = tab.length) &gt; <span class="hljs-number">0</span> &amp;&amp;<br>        (first = tab[(n - <span class="hljs-number">1</span>) &amp; hash]) != <span class="hljs-literal">null</span>) &#123;<br><br>        <span class="hljs-comment">// 第一种情况: 定位出来的桶元素 即为咱们要get的数据</span><br>        <span class="hljs-keyword">if</span> (first.hash == hash &amp;&amp; <span class="hljs-comment">// always check first node</span><br>            ((k = first.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k))))<br>            <span class="hljs-keyword">return</span> first;<br>        <br>        <span class="hljs-comment">// 说明当前桶位不止一个元素, 可能是链表 也可能是红黑树</span><br>        <span class="hljs-keyword">if</span> ((e = first.next) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-comment">// 第二种情况: 桶位升级成了红黑树</span><br>            <span class="hljs-keyword">if</span> (first <span class="hljs-keyword">instanceof</span> TreeNode)<br>                <span class="hljs-keyword">return</span> ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);<br>            <span class="hljs-keyword">do</span> &#123;<br>                <span class="hljs-comment">// 第三种情况, 桶位形成链表</span><br>                <span class="hljs-keyword">if</span> (e.hash == hash &amp;&amp;<br>                    ((k = e.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k))))<br>                    <span class="hljs-keyword">return</span> e;<br>            &#125; <span class="hljs-keyword">while</span> ((e = e.next) != <span class="hljs-literal">null</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns &lt;tt&gt;true&lt;/tt&gt; if this map contains a mapping for the</span><br><span class="hljs-comment"> * specified key.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>   key   The key whose presence in this map is to be tested</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &lt;tt&gt;true&lt;/tt&gt; if this map contains a mapping for the specified</span><br><span class="hljs-comment"> * key.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">containsKey</span><span class="hljs-params">(Object key)</span> &#123;<br>    <span class="hljs-keyword">return</span> getNode(hash(key), key) != <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Associates the specified value with the specified key in this map.</span><br><span class="hljs-comment"> * If the map previously contained a mapping for the key, the old</span><br><span class="hljs-comment"> * value is replaced.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> key key with which the specified value is to be associated</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> value value to be associated with the specified key</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> the previous value associated with &lt;tt&gt;key&lt;/tt&gt;, or</span><br><span class="hljs-comment"> *         &lt;tt&gt;null&lt;/tt&gt; if there was no mapping for &lt;tt&gt;key&lt;/tt&gt;.</span><br><span class="hljs-comment"> *         (A &lt;tt&gt;null&lt;/tt&gt; return can also indicate that the map</span><br><span class="hljs-comment"> *         previously associated &lt;tt&gt;null&lt;/tt&gt; with &lt;tt&gt;key&lt;/tt&gt;.)</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> V <span class="hljs-title function_">put</span><span class="hljs-params">(K key, V value)</span> &#123;<br>    <span class="hljs-keyword">return</span> putVal(hash(key), key, value, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Implements Map.put and related methods</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> hash hash for key</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> key the key</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> value the value to put</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> onlyIfAbsent if true, don&#x27;t change existing value</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> evict if false, the table is in creation mode.</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> previous value, or null if none</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">final</span> V <span class="hljs-title function_">putVal</span><span class="hljs-params">(<span class="hljs-type">int</span> hash, K key, V value, <span class="hljs-type">boolean</span> onlyIfAbsent,</span><br><span class="hljs-params">               <span class="hljs-type">boolean</span> evict)</span> &#123;<br>    <span class="hljs-comment">// tab: 引用当前hashMap的散列表</span><br>    <span class="hljs-comment">// p: 表示当前散列表的元素</span><br>    <span class="hljs-comment">// n: 表示散列表数组的长度</span><br>    <span class="hljs-comment">// i: 表示路由寻址结构</span><br>    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="hljs-type">int</span> n, i;<br><br>    <span class="hljs-comment">// 延迟初始化逻辑, 第一次调用putVal时会初始化hashMap对象中的最耗费内存的散列表</span><br>    <span class="hljs-keyword">if</span> ((tab = table) == <span class="hljs-literal">null</span> || (n = tab.length) == <span class="hljs-number">0</span>)<br>        n = (tab = resize()).length;<br>    <br>    <span class="hljs-comment">// 最简单的一种情况: 寻址找到的桶位 刚好是 null , 这个时候, 直接将当前 k-v =&gt; node 扔进入就可以了</span><br>    <span class="hljs-keyword">if</span> ((p = tab[i = (n - <span class="hljs-number">1</span>) &amp; hash]) == <span class="hljs-literal">null</span>)<br>        tab[i] = newNode(hash, key, value, <span class="hljs-literal">null</span>);<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-comment">// e: 不为null的话, 找到了一个与当前要插入的key-value一致的key的元素</span><br>        <span class="hljs-comment">// k: 表示临时的一个key</span><br>        Node&lt;K,V&gt; e; K k;<br><br>        <span class="hljs-comment">// 表示桶位中的该元素, 与你当前插入的元素的key完全一致, 表示后续需要进行替换操作</span><br>        <span class="hljs-keyword">if</span> (p.hash == hash &amp;&amp;<br>            ((k = p.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k))))<br>            e = p;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (p <span class="hljs-keyword">instanceof</span> TreeNode) <span class="hljs-comment">// 红黑树</span><br>            e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="hljs-built_in">this</span>, tab, hash, key, value);<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// 链表的情况, 而且链表的头元素与我们要插入key不一致</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">binCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; ; ++binCount) &#123;<br><br>                <span class="hljs-comment">// 条件成立的话, 说明迭代到最后一个元素了, 也没找到一个与你要插入的key一致的node</span><br>                <span class="hljs-comment">// 说明需要加入到当前链表的末尾</span><br>                <span class="hljs-keyword">if</span> ((e = p.next) == <span class="hljs-literal">null</span>) &#123;<br>                    p.next = newNode(hash, key, value, <span class="hljs-literal">null</span>);<br>                    <span class="hljs-comment">// 条件成立的话, 说明当前链表的长度, 达到了树化的标准了, 需要进行树化</span><br>                    <span class="hljs-keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="hljs-number">1</span>) <span class="hljs-comment">// -1 for 1st</span><br>                        <span class="hljs-comment">// 树化操作</span><br>                        treeifyBin(tab, hash);<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>                <span class="hljs-comment">// 条件成立的话, 说明找到了相同key的node元素, 需要进行替换操作</span><br>                <span class="hljs-keyword">if</span> (e.hash == hash &amp;&amp;<br>                    ((k = e.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k))))<br>                    <span class="hljs-keyword">break</span>;<br>                p = e;<br>            &#125;<br>        &#125;<br>        <span class="hljs-comment">// e不等于null, 条件成立说明, 找到了一个与你插入元素key完全一致的数据, 需要进行替换</span><br>        <span class="hljs-keyword">if</span> (e != <span class="hljs-literal">null</span>) &#123; <span class="hljs-comment">// existing mapping for key</span><br>            <span class="hljs-type">V</span> <span class="hljs-variable">oldValue</span> <span class="hljs-operator">=</span> e.value;<br>            <span class="hljs-keyword">if</span> (!onlyIfAbsent || oldValue == <span class="hljs-literal">null</span>)<br>                e.value = value;<br>            afterNodeAccess(e);<br>            <span class="hljs-keyword">return</span> oldValue;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// modCount: 表示散列表结构被修改的次数, 替换Node元素的value不计数</span><br>    ++modCount;<br><br>    <span class="hljs-comment">// 插入新元素, size自增, 如果自增后的值大于扩容阈值, 则触发扩容</span><br>    <span class="hljs-keyword">if</span> (++size &gt; threshold)<br>        resize();<br>    afterNodeInsertion(evict);<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Initializes or doubles table size.  If null, allocates in</span><br><span class="hljs-comment"> * accord with initial capacity target held in field threshold.</span><br><span class="hljs-comment"> * Otherwise, because we are using power-of-two expansion, the</span><br><span class="hljs-comment"> * elements from each bin must either stay at same index, or move</span><br><span class="hljs-comment"> * with a power of two offset in the new table.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * 为什么需要扩容? </span><br><span class="hljs-comment"> * 为了解决哈希冲突导致的链化影响查询效率的问题, 扩容会缓解该问题</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> the table</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">final</span> Node&lt;K,V&gt;[] resize() &#123;<br>    <span class="hljs-comment">// oldTab: 引用扩容前的哈希表</span><br>    Node&lt;K,V&gt;[] oldTab = table;<br>    <br>    <span class="hljs-comment">// oldCap: 表示扩容之前的table数组的长度</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">oldCap</span> <span class="hljs-operator">=</span> (oldTab == <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : oldTab.length;<br>    <span class="hljs-comment">// oldCap: 表示扩容之前的扩容阈值, 触发本次扩容的阈值</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">oldThr</span> <span class="hljs-operator">=</span> threshold;<br>    <span class="hljs-comment">// newCap: 扩容之后table数组的大小</span><br>    <span class="hljs-comment">// newThr: 扩容之后, 下次再次触发扩容的条件 </span><br>    <span class="hljs-type">int</span> newCap, newThr = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-comment">// 条件如果成立说明 hashMap 中的散列表已经初始化过了, 是一次正常扩容</span><br>    <span class="hljs-keyword">if</span> (oldCap &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-comment">// 扩容之前的 table 数组大小已经达到最大阈值后, 则不扩容, 且设置扩容条件作为 int 最大值</span><br>        <span class="hljs-keyword">if</span> (oldCap &gt;= MAXIMUM_CAPACITY) &#123;<br>            threshold = Integer.MAX_VALUE;<br>            <span class="hljs-keyword">return</span> oldTab;<br>        &#125;<br><br>        <span class="hljs-comment">// oldCap 左移一位实现数值翻倍, 并且复制给newCap, newCap 小于数组最大值限制 且扩容之前的阈值 &gt;= 16</span><br>        <span class="hljs-comment">// 这种情况下, 则 下一次扩容的阈值 等于当前阈值翻倍</span><br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((newCap = oldCap &lt;&lt; <span class="hljs-number">1</span>) &lt; MAXIMUM_CAPACITY &amp;&amp;<br>                 oldCap &gt;= DEFAULT_INITIAL_CAPACITY)<br>            newThr = oldThr &lt;&lt; <span class="hljs-number">1</span>; <span class="hljs-comment">// double threshold</span><br>    &#125;<br><br>    <span class="hljs-comment">// oldCap == 0, 说明HashMap中的散列表是null</span><br>    <span class="hljs-comment">// 1. new HashMap(initCap, loadFactor);</span><br>    <span class="hljs-comment">// 2. new HashMap(initCap);</span><br>    <span class="hljs-comment">// 3. new HashMap(map); 并且这个map有数据</span><br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (oldThr &gt; <span class="hljs-number">0</span>) <span class="hljs-comment">// initial capacity was placed in threshold</span><br>        newCap = oldThr;<br>    <br>    <span class="hljs-comment">// oldCap == 0, oldThr == 0</span><br>    <span class="hljs-comment">// new HashMap();</span><br>    <span class="hljs-keyword">else</span> &#123;               <span class="hljs-comment">// zero initial threshold signifies using defaults</span><br>        newCap = DEFAULT_INITIAL_CAPACITY;<br>        newThr = (<span class="hljs-type">int</span>)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);<br>    &#125;<br><br>    <span class="hljs-comment">// newThr 为零时, 通过 newCap 和 loadFactor 计算出一个 newThr</span><br>    <span class="hljs-keyword">if</span> (newThr == <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-type">float</span> <span class="hljs-variable">ft</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>)newCap * loadFactor;<br>        newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (<span class="hljs-type">float</span>)MAXIMUM_CAPACITY ?<br>                  (<span class="hljs-type">int</span>)ft : Integer.MAX_VALUE);<br>    &#125;<br>    threshold = newThr;<br><br>    <span class="hljs-comment">// 创建出一个更长更大的数组</span><br>    <span class="hljs-meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span><br>    Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])<span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>[newCap];<br>    table = newTab;<br>    <span class="hljs-comment">// 说明, hashMap本次扩容之前, table不为null</span><br>    <span class="hljs-keyword">if</span> (oldTab != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">j</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; j &lt; oldCap; ++j) &#123;<br>            <span class="hljs-comment">// 当前Node节点</span><br>            Node&lt;K,V&gt; e;<br>            <span class="hljs-comment">// 说明当前桶位中有数据, 但是数据具体是 单个树, 还是链表 还是红黑树并不知道</span><br>            <span class="hljs-keyword">if</span> ((e = oldTab[j]) != <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-comment">// 方便JVM GC时回收内存</span><br>                oldTab[j] = <span class="hljs-literal">null</span>;<br><br>                <span class="hljs-comment">// 第一种情况: 当前桶位只有一个元素, 从未发生过碰撞, 这情况 直接计算出当前元素应存放在 新数组中的位置</span><br>                <span class="hljs-comment">// 然后扔进去就可以了</span><br>                <span class="hljs-keyword">if</span> (e.next == <span class="hljs-literal">null</span>)<br>                    newTab[e.hash &amp; (newCap - <span class="hljs-number">1</span>)] = e;<br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e <span class="hljs-keyword">instanceof</span> TreeNode)<br>                    ((TreeNode&lt;K,V&gt;)e).split(<span class="hljs-built_in">this</span>, newTab, j, oldCap);<br>                <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// preserve order</span><br>                    <span class="hljs-comment">// 第三种  情况: 桶位已经形成链表</span><br><br>                    <span class="hljs-comment">// 低位链表: 存放在扩容之后的数组的下标位置, 与当前数组的下标位置一致</span><br>                    Node&lt;K,V&gt; loHead = <span class="hljs-literal">null</span>, loTail = <span class="hljs-literal">null</span>;<br><br>                    <span class="hljs-comment">// 高位链表: 存放在扩容之后的数组的下标位置为 当前数组下标位置 + 扩容之前的数组的长度</span><br>                    Node&lt;K,V&gt; hiHead = <span class="hljs-literal">null</span>, hiTail = <span class="hljs-literal">null</span>;<br>                    Node&lt;K,V&gt; next;<br>                    <span class="hljs-keyword">do</span> &#123;<br>                        next = e.next;<br><br>                        <span class="hljs-comment">// 判断低 第五位是 0 还是 1</span><br>                        <span class="hljs-comment">// hash =&gt; ... 1 1111</span><br>                        <span class="hljs-comment">// hash =&gt; ... 0 1111</span><br>                        <span class="hljs-comment">// 0b 10000</span><br>                        <span class="hljs-keyword">if</span> ((e.hash &amp; oldCap) == <span class="hljs-number">0</span>) &#123;<br>                            <span class="hljs-keyword">if</span> (loTail == <span class="hljs-literal">null</span>)<br>                                loHead = e;<br>                            <span class="hljs-keyword">else</span><br>                                loTail.next = e;<br>                            loTail = e;<br>                        &#125;<br>                        <span class="hljs-keyword">else</span> &#123;<br>                            <span class="hljs-keyword">if</span> (hiTail == <span class="hljs-literal">null</span>)<br>                                hiHead = e;<br>                            <span class="hljs-keyword">else</span><br>                                hiTail.next = e;<br>                            hiTail = e;<br>                        &#125;<br>                    &#125; <span class="hljs-keyword">while</span> ((e = next) != <span class="hljs-literal">null</span>);<br>                    <span class="hljs-keyword">if</span> (loTail != <span class="hljs-literal">null</span>) &#123;<br>                        loTail.next = <span class="hljs-literal">null</span>;<br>                        newTab[j] = loHead;<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> (hiTail != <span class="hljs-literal">null</span>) &#123;<br>                        hiTail.next = <span class="hljs-literal">null</span>;<br>                        newTab[j + oldCap] = hiHead;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> newTab;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Replaces all linked nodes in bin at index for given hash unless</span><br><span class="hljs-comment"> * table is too small, in which case resizes instead.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">treeifyBin</span><span class="hljs-params">(Node&lt;K,V&gt;[] tab, <span class="hljs-type">int</span> hash)</span> &#123;<br>    <span class="hljs-type">int</span> n, index; Node&lt;K,V&gt; e;<br>    <span class="hljs-keyword">if</span> (tab == <span class="hljs-literal">null</span> || (n = tab.length) &lt; MIN_TREEIFY_CAPACITY)<br>        resize();<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((e = tab[index = (n - <span class="hljs-number">1</span>) &amp; hash]) != <span class="hljs-literal">null</span>) &#123;<br>        TreeNode&lt;K,V&gt; hd = <span class="hljs-literal">null</span>, tl = <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">do</span> &#123;<br>            TreeNode&lt;K,V&gt; p = replacementTreeNode(e, <span class="hljs-literal">null</span>);<br>            <span class="hljs-keyword">if</span> (tl == <span class="hljs-literal">null</span>)<br>                hd = p;<br>            <span class="hljs-keyword">else</span> &#123;<br>                p.prev = tl;<br>                tl.next = p;<br>            &#125;<br>            tl = p;<br>        &#125; <span class="hljs-keyword">while</span> ((e = e.next) != <span class="hljs-literal">null</span>);<br>        <span class="hljs-keyword">if</span> ((tab[index] = hd) != <span class="hljs-literal">null</span>)<br>            hd.treeify(tab);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Copies all of the mappings from the specified map to this map.</span><br><span class="hljs-comment"> * These mappings will replace any mappings that this map had for</span><br><span class="hljs-comment"> * any of the keys currently in the specified map.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> m mappings to be stored in this map</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@throws</span> NullPointerException if the specified map is null</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">putAll</span><span class="hljs-params">(Map&lt;? extends K, ? extends V&gt; m)</span> &#123;<br>    putMapEntries(m, <span class="hljs-literal">true</span>);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Removes the mapping for the specified key from this map if present.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span>  key key whose mapping is to be removed from the map</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> the previous value associated with &lt;tt&gt;key&lt;/tt&gt;, or</span><br><span class="hljs-comment"> *         &lt;tt&gt;null&lt;/tt&gt; if there was no mapping for &lt;tt&gt;key&lt;/tt&gt;.</span><br><span class="hljs-comment"> *         (A &lt;tt&gt;null&lt;/tt&gt; return can also indicate that the map</span><br><span class="hljs-comment"> *         previously associated &lt;tt&gt;null&lt;/tt&gt; with &lt;tt&gt;key&lt;/tt&gt;.)</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> V <span class="hljs-title function_">remove</span><span class="hljs-params">(Object key)</span> &#123;<br>    Node&lt;K,V&gt; e;<br>    <span class="hljs-keyword">return</span> (e = removeNode(hash(key), key, <span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>)) == <span class="hljs-literal">null</span> ?<br>        <span class="hljs-literal">null</span> : e.value;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Implements Map.remove and related methods</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> hash hash for key</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> key the key</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> value the value to match if matchValue, else ignored</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> matchValue if true only remove if value is equal</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> movable if false do not move other nodes while removing</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> the node, or null if none</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">final</span> Node&lt;K,V&gt; <span class="hljs-title function_">removeNode</span><span class="hljs-params">(<span class="hljs-type">int</span> hash, Object key, Object value,</span><br><span class="hljs-params">                           <span class="hljs-type">boolean</span> matchValue, <span class="hljs-type">boolean</span> movable)</span> &#123;<br>    <span class="hljs-comment">// tab: 引用当前HashMap中的散列表</span><br>    <span class="hljs-comment">// p: 当前Node节点</span><br>    <span class="hljs-comment">// n: 表示散列表数组长度</span><br>    <span class="hljs-comment">// index: 表示寻址结果</span><br>    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="hljs-type">int</span> n, index;<br>    <span class="hljs-keyword">if</span> ((tab = table) != <span class="hljs-literal">null</span> &amp;&amp; (n = tab.length) &gt; <span class="hljs-number">0</span> &amp;&amp;<br>        (p = tab[index = (n - <span class="hljs-number">1</span>) &amp; hash]) != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-comment">// 说明路由的桶位置有数据的, 需要进行查找操作, 并且删除</span><br><br>        <span class="hljs-comment">// node: 查找到的结果</span><br>        <span class="hljs-comment">// e: 当前Node的下一个元素</span><br>        Node&lt;K,V&gt; node = <span class="hljs-literal">null</span>, e; K k; V v;<br><br>        <span class="hljs-comment">// 第一种情况: 当前桶位中的元素 即为你要删除的元素</span><br>        <span class="hljs-keyword">if</span> (p.hash == hash &amp;&amp;<br>            ((k = p.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k))))<br>            node = p;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((e = p.next) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-comment">// 说明当前桶位要么是链表要么是红黑树</span><br>            <span class="hljs-keyword">if</span> (p <span class="hljs-keyword">instanceof</span> TreeNode) <span class="hljs-comment">// 判断当前桶位是否升级为红黑树了</span><br>                <span class="hljs-comment">// 第二种情况</span><br>                <span class="hljs-comment">// 红黑树查找操作</span><br>                node = ((TreeNode&lt;K,V&gt;)p).getTreeNode(hash, key);<br>            <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-comment">// 第三种情况</span><br>                <span class="hljs-comment">// 链表的情况</span><br>                <span class="hljs-keyword">do</span> &#123;<br>                    <span class="hljs-keyword">if</span> (e.hash == hash &amp;&amp;<br>                        ((k = e.key) == key ||<br>                         (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k)))) &#123;<br>                        node = e;<br>                        <span class="hljs-keyword">break</span>;<br>                    &#125;<br>                    p = e;<br>                &#125; <span class="hljs-keyword">while</span> ((e = e.next) != <span class="hljs-literal">null</span>);<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-comment">// 判断node不为空的话, 说明按照key查找到需要删除的数据了</span><br>        <span class="hljs-keyword">if</span> (node != <span class="hljs-literal">null</span> &amp;&amp; (!matchValue || (v = node.value) == value ||<br>                             (value != <span class="hljs-literal">null</span> &amp;&amp; value.equals(v)))) &#123;<br>            <span class="hljs-comment">// 第一种情况: node是树节点, 说明需要进行树节点移除操作</span><br>            <span class="hljs-keyword">if</span> (node <span class="hljs-keyword">instanceof</span> TreeNode)<br>                ((TreeNode&lt;K,V&gt;)node).removeTreeNode(<span class="hljs-built_in">this</span>, tab, movable);<br>            <span class="hljs-comment">// 第二种情况: 桶位元素即为查找结果, 则将该元素的下一个元素放至桶位中</span><br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (node == p)<br>                tab[index] = node.next;<br>            <span class="hljs-comment">// 第三种情况: 将当前元素p的下一个元素 设置成要删除元素的下一个元素</span><br>            <span class="hljs-keyword">else</span><br>                p.next = node.next;<br>            ++modCount;<br>            --size;<br>            afterNodeRemoval(node);<br>            <span class="hljs-keyword">return</span> node;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Removes all of the mappings from this map.</span><br><span class="hljs-comment"> * The map will be empty after this call returns.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span> &#123;<br>    Node&lt;K,V&gt;[] tab;<br>    modCount++;<br>    <span class="hljs-keyword">if</span> ((tab = table) != <span class="hljs-literal">null</span> &amp;&amp; size &gt; <span class="hljs-number">0</span>) &#123;<br>        size = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; tab.length; ++i)<br>            tab[i] = <span class="hljs-literal">null</span>;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns &lt;tt&gt;true&lt;/tt&gt; if this map maps one or more keys to the</span><br><span class="hljs-comment"> * specified value.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param</span> value value whose presence in this map is to be tested</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> &lt;tt&gt;true&lt;/tt&gt; if this map maps one or more keys to the</span><br><span class="hljs-comment"> *         specified value</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">containsValue</span><span class="hljs-params">(Object value)</span> &#123;<br>    Node&lt;K,V&gt;[] tab; V v;<br>    <span class="hljs-keyword">if</span> ((tab = table) != <span class="hljs-literal">null</span> &amp;&amp; size &gt; <span class="hljs-number">0</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; tab.length; ++i) &#123;<br>            <span class="hljs-keyword">for</span> (Node&lt;K,V&gt; e = tab[i]; e != <span class="hljs-literal">null</span>; e = e.next) &#123;<br>                <span class="hljs-keyword">if</span> ((v = e.value) == value ||<br>                    (value != <span class="hljs-literal">null</span> &amp;&amp; value.equals(v)))<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns a &#123;<span class="hljs-doctag">@link</span> Set&#125; view of the keys contained in this map.</span><br><span class="hljs-comment"> * The set is backed by the map, so changes to the map are</span><br><span class="hljs-comment"> * reflected in the set, and vice-versa.  If the map is modified</span><br><span class="hljs-comment"> * while an iteration over the set is in progress (except through</span><br><span class="hljs-comment"> * the iterator&#x27;s own &lt;tt&gt;remove&lt;/tt&gt; operation), the results of</span><br><span class="hljs-comment"> * the iteration are undefined.  The set supports element removal,</span><br><span class="hljs-comment"> * which removes the corresponding mapping from the map, via the</span><br><span class="hljs-comment"> * &lt;tt&gt;Iterator.remove&lt;/tt&gt;, &lt;tt&gt;Set.remove&lt;/tt&gt;,</span><br><span class="hljs-comment"> * &lt;tt&gt;removeAll&lt;/tt&gt;, &lt;tt&gt;retainAll&lt;/tt&gt;, and &lt;tt&gt;clear&lt;/tt&gt;</span><br><span class="hljs-comment"> * operations.  It does not support the &lt;tt&gt;add&lt;/tt&gt; or &lt;tt&gt;addAll&lt;/tt&gt;</span><br><span class="hljs-comment"> * operations.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> a set view of the keys contained in this map</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> Set&lt;K&gt; <span class="hljs-title function_">keySet</span><span class="hljs-params">()</span> &#123;<br>    Set&lt;K&gt; ks = keySet;<br>    <span class="hljs-keyword">if</span> (ks == <span class="hljs-literal">null</span>) &#123;<br>        ks = <span class="hljs-keyword">new</span> <span class="hljs-title class_">KeySet</span>();<br>        keySet = ks;<br>    &#125;<br>    <span class="hljs-keyword">return</span> ks;<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">KeySet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractSet</span>&lt;K&gt; &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span>                 &#123; <span class="hljs-keyword">return</span> size; &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span>               &#123; HashMap.<span class="hljs-built_in">this</span>.clear(); &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Iterator&lt;K&gt; <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span>     &#123; <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">KeyIterator</span>(); &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">contains</span><span class="hljs-params">(Object o)</span> &#123; <span class="hljs-keyword">return</span> containsKey(o); &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">remove</span><span class="hljs-params">(Object key)</span> &#123;<br>        <span class="hljs-keyword">return</span> removeNode(hash(key), key, <span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>) != <span class="hljs-literal">null</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Spliterator&lt;K&gt; <span class="hljs-title function_">spliterator</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">KeySpliterator</span>&lt;&gt;(HashMap.<span class="hljs-built_in">this</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEach</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> K&gt; action)</span> &#123;<br>        Node&lt;K,V&gt;[] tab;<br>        <span class="hljs-keyword">if</span> (action == <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>        <span class="hljs-keyword">if</span> (size &gt; <span class="hljs-number">0</span> &amp;&amp; (tab = table) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">mc</span> <span class="hljs-operator">=</span> modCount;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; tab.length; ++i) &#123;<br>                <span class="hljs-keyword">for</span> (Node&lt;K,V&gt; e = tab[i]; e != <span class="hljs-literal">null</span>; e = e.next)<br>                    action.accept(e.key);<br>            &#125;<br>            <span class="hljs-keyword">if</span> (modCount != mc)<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns a &#123;<span class="hljs-doctag">@link</span> Collection&#125; view of the values contained in this map.</span><br><span class="hljs-comment"> * The collection is backed by the map, so changes to the map are</span><br><span class="hljs-comment"> * reflected in the collection, and vice-versa.  If the map is</span><br><span class="hljs-comment"> * modified while an iteration over the collection is in progress</span><br><span class="hljs-comment"> * (except through the iterator&#x27;s own &lt;tt&gt;remove&lt;/tt&gt; operation),</span><br><span class="hljs-comment"> * the results of the iteration are undefined.  The collection</span><br><span class="hljs-comment"> * supports element removal, which removes the corresponding</span><br><span class="hljs-comment"> * mapping from the map, via the &lt;tt&gt;Iterator.remove&lt;/tt&gt;,</span><br><span class="hljs-comment"> * &lt;tt&gt;Collection.remove&lt;/tt&gt;, &lt;tt&gt;removeAll&lt;/tt&gt;,</span><br><span class="hljs-comment"> * &lt;tt&gt;retainAll&lt;/tt&gt; and &lt;tt&gt;clear&lt;/tt&gt; operations.  It does not</span><br><span class="hljs-comment"> * support the &lt;tt&gt;add&lt;/tt&gt; or &lt;tt&gt;addAll&lt;/tt&gt; operations.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> a view of the values contained in this map</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> Collection&lt;V&gt; <span class="hljs-title function_">values</span><span class="hljs-params">()</span> &#123;<br>    Collection&lt;V&gt; vs = values;<br>    <span class="hljs-keyword">if</span> (vs == <span class="hljs-literal">null</span>) &#123;<br>        vs = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Values</span>();<br>        values = vs;<br>    &#125;<br>    <span class="hljs-keyword">return</span> vs;<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Values</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractCollection</span>&lt;V&gt; &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span>                 &#123; <span class="hljs-keyword">return</span> size; &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span>               &#123; HashMap.<span class="hljs-built_in">this</span>.clear(); &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Iterator&lt;V&gt; <span class="hljs-title function_">iterator</span><span class="hljs-params">()</span>     &#123; <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ValueIterator</span>(); &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">contains</span><span class="hljs-params">(Object o)</span> &#123; <span class="hljs-keyword">return</span> containsValue(o); &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Spliterator&lt;V&gt; <span class="hljs-title function_">spliterator</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ValueSpliterator</span>&lt;&gt;(HashMap.<span class="hljs-built_in">this</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEach</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> V&gt; action)</span> &#123;<br>        Node&lt;K,V&gt;[] tab;<br>        <span class="hljs-keyword">if</span> (action == <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>        <span class="hljs-keyword">if</span> (size &gt; <span class="hljs-number">0</span> &amp;&amp; (tab = table) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">mc</span> <span class="hljs-operator">=</span> modCount;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; tab.length; ++i) &#123;<br>                <span class="hljs-keyword">for</span> (Node&lt;K,V&gt; e = tab[i]; e != <span class="hljs-literal">null</span>; e = e.next)<br>                    action.accept(e.value);<br>            &#125;<br>            <span class="hljs-keyword">if</span> (modCount != mc)<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns a &#123;<span class="hljs-doctag">@link</span> Set&#125; view of the mappings contained in this map.</span><br><span class="hljs-comment"> * The set is backed by the map, so changes to the map are</span><br><span class="hljs-comment"> * reflected in the set, and vice-versa.  If the map is modified</span><br><span class="hljs-comment"> * while an iteration over the set is in progress (except through</span><br><span class="hljs-comment"> * the iterator&#x27;s own &lt;tt&gt;remove&lt;/tt&gt; operation, or through the</span><br><span class="hljs-comment"> * &lt;tt&gt;setValue&lt;/tt&gt; operation on a map entry returned by the</span><br><span class="hljs-comment"> * iterator) the results of the iteration are undefined.  The set</span><br><span class="hljs-comment"> * supports element removal, which removes the corresponding</span><br><span class="hljs-comment"> * mapping from the map, via the &lt;tt&gt;Iterator.remove&lt;/tt&gt;,</span><br><span class="hljs-comment"> * &lt;tt&gt;Set.remove&lt;/tt&gt;, &lt;tt&gt;removeAll&lt;/tt&gt;, &lt;tt&gt;retainAll&lt;/tt&gt; and</span><br><span class="hljs-comment"> * &lt;tt&gt;clear&lt;/tt&gt; operations.  It does not support the</span><br><span class="hljs-comment"> * &lt;tt&gt;add&lt;/tt&gt; or &lt;tt&gt;addAll&lt;/tt&gt; operations.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> a set view of the mappings contained in this map</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">public</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet() &#123;<br>    Set&lt;Map.Entry&lt;K,V&gt;&gt; es;<br>    <span class="hljs-keyword">return</span> (es = entrySet) == <span class="hljs-literal">null</span> ? (entrySet = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EntrySet</span>()) : es;<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntrySet</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractSet</span>&lt;Map.Entry&lt;K,V&gt;&gt; &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">size</span><span class="hljs-params">()</span>                 &#123; <span class="hljs-keyword">return</span> size; &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">clear</span><span class="hljs-params">()</span>               &#123; HashMap.<span class="hljs-built_in">this</span>.clear(); &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Iterator&lt;Map.Entry&lt;K,V&gt;&gt; iterator() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EntryIterator</span>();<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">contains</span><span class="hljs-params">(Object o)</span> &#123;<br>        <span class="hljs-keyword">if</span> (!(o <span class="hljs-keyword">instanceof</span> Map.Entry))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;) o;<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> e.getKey();<br>        Node&lt;K,V&gt; candidate = getNode(hash(key), key);<br>        <span class="hljs-keyword">return</span> candidate != <span class="hljs-literal">null</span> &amp;&amp; candidate.equals(e);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">remove</span><span class="hljs-params">(Object o)</span> &#123;<br>        <span class="hljs-keyword">if</span> (o <span class="hljs-keyword">instanceof</span> Map.Entry) &#123;<br>            Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;) o;<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> e.getKey();<br>            <span class="hljs-type">Object</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> e.getValue();<br>            <span class="hljs-keyword">return</span> removeNode(hash(key), key, value, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>) != <span class="hljs-literal">null</span>;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Spliterator&lt;Map.Entry&lt;K,V&gt;&gt; spliterator() &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">EntrySpliterator</span>&lt;&gt;(HashMap.<span class="hljs-built_in">this</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEach</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> Map.Entry&lt;K,V&gt;&gt; action)</span> &#123;<br>        Node&lt;K,V&gt;[] tab;<br>        <span class="hljs-keyword">if</span> (action == <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>        <span class="hljs-keyword">if</span> (size &gt; <span class="hljs-number">0</span> &amp;&amp; (tab = table) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">mc</span> <span class="hljs-operator">=</span> modCount;<br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; tab.length; ++i) &#123;<br>                <span class="hljs-keyword">for</span> (Node&lt;K,V&gt; e = tab[i]; e != <span class="hljs-literal">null</span>; e = e.next)<br>                    action.accept(e);<br>            &#125;<br>            <span class="hljs-keyword">if</span> (modCount != mc)<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">// Overrides of JDK8 Map extension methods</span><br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> V <span class="hljs-title function_">getOrDefault</span><span class="hljs-params">(Object key, V defaultValue)</span> &#123;<br>    Node&lt;K,V&gt; e;<br>    <span class="hljs-keyword">return</span> (e = getNode(hash(key), key)) == <span class="hljs-literal">null</span> ? defaultValue : e.value;<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> V <span class="hljs-title function_">putIfAbsent</span><span class="hljs-params">(K key, V value)</span> &#123;<br>    <span class="hljs-keyword">return</span> putVal(hash(key), key, value, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>);<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">remove</span><span class="hljs-params">(Object key, Object value)</span> &#123;<br>    <span class="hljs-keyword">return</span> removeNode(hash(key), key, value, <span class="hljs-literal">true</span>, <span class="hljs-literal">true</span>) != <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">replace</span><span class="hljs-params">(K key, V oldValue, V newValue)</span> &#123;<br>    Node&lt;K,V&gt; e; V v;<br>    <span class="hljs-keyword">if</span> ((e = getNode(hash(key), key)) != <span class="hljs-literal">null</span> &amp;&amp;<br>        ((v = e.value) == oldValue || (v != <span class="hljs-literal">null</span> &amp;&amp; v.equals(oldValue)))) &#123;<br>        e.value = newValue;<br>        afterNodeAccess(e);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> V <span class="hljs-title function_">replace</span><span class="hljs-params">(K key, V value)</span> &#123;<br>    Node&lt;K,V&gt; e;<br>    <span class="hljs-keyword">if</span> ((e = getNode(hash(key), key)) != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-type">V</span> <span class="hljs-variable">oldValue</span> <span class="hljs-operator">=</span> e.value;<br>        e.value = value;<br>        afterNodeAccess(e);<br>        <span class="hljs-keyword">return</span> oldValue;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> V <span class="hljs-title function_">computeIfAbsent</span><span class="hljs-params">(K key,</span><br><span class="hljs-params">                         Function&lt;? <span class="hljs-built_in">super</span> K, ? extends V&gt; mappingFunction)</span> &#123;<br>    <span class="hljs-keyword">if</span> (mappingFunction == <span class="hljs-literal">null</span>)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>    <span class="hljs-type">int</span> <span class="hljs-variable">hash</span> <span class="hljs-operator">=</span> hash(key);<br>    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first; <span class="hljs-type">int</span> n, i;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">binCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    TreeNode&lt;K,V&gt; t = <span class="hljs-literal">null</span>;<br>    Node&lt;K,V&gt; old = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">if</span> (size &gt; threshold || (tab = table) == <span class="hljs-literal">null</span> ||<br>        (n = tab.length) == <span class="hljs-number">0</span>)<br>        n = (tab = resize()).length;<br>    <span class="hljs-keyword">if</span> ((first = tab[i = (n - <span class="hljs-number">1</span>) &amp; hash]) != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">if</span> (first <span class="hljs-keyword">instanceof</span> TreeNode)<br>            old = (t = (TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);<br>        <span class="hljs-keyword">else</span> &#123;<br>            Node&lt;K,V&gt; e = first; K k;<br>            <span class="hljs-keyword">do</span> &#123;<br>                <span class="hljs-keyword">if</span> (e.hash == hash &amp;&amp;<br>                    ((k = e.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k)))) &#123;<br>                    old = e;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>                ++binCount;<br>            &#125; <span class="hljs-keyword">while</span> ((e = e.next) != <span class="hljs-literal">null</span>);<br>        &#125;<br>        V oldValue;<br>        <span class="hljs-keyword">if</span> (old != <span class="hljs-literal">null</span> &amp;&amp; (oldValue = old.value) != <span class="hljs-literal">null</span>) &#123;<br>            afterNodeAccess(old);<br>            <span class="hljs-keyword">return</span> oldValue;<br>        &#125;<br>    &#125;<br>    <span class="hljs-type">V</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> mappingFunction.apply(key);<br>    <span class="hljs-keyword">if</span> (v == <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (old != <span class="hljs-literal">null</span>) &#123;<br>        old.value = v;<br>        afterNodeAccess(old);<br>        <span class="hljs-keyword">return</span> v;<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (t != <span class="hljs-literal">null</span>)<br>        t.putTreeVal(<span class="hljs-built_in">this</span>, tab, hash, key, v);<br>    <span class="hljs-keyword">else</span> &#123;<br>        tab[i] = newNode(hash, key, v, first);<br>        <span class="hljs-keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="hljs-number">1</span>)<br>            treeifyBin(tab, hash);<br>    &#125;<br>    ++modCount;<br>    ++size;<br>    afterNodeInsertion(<span class="hljs-literal">true</span>);<br>    <span class="hljs-keyword">return</span> v;<br>&#125;<br><br><span class="hljs-keyword">public</span> V <span class="hljs-title function_">computeIfPresent</span><span class="hljs-params">(K key,</span><br><span class="hljs-params">                          BiFunction&lt;? <span class="hljs-built_in">super</span> K, ? <span class="hljs-built_in">super</span> V, ? extends V&gt; remappingFunction)</span> &#123;<br>    <span class="hljs-keyword">if</span> (remappingFunction == <span class="hljs-literal">null</span>)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>    Node&lt;K,V&gt; e; V oldValue;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">hash</span> <span class="hljs-operator">=</span> hash(key);<br>    <span class="hljs-keyword">if</span> ((e = getNode(hash, key)) != <span class="hljs-literal">null</span> &amp;&amp;<br>        (oldValue = e.value) != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-type">V</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> remappingFunction.apply(key, oldValue);<br>        <span class="hljs-keyword">if</span> (v != <span class="hljs-literal">null</span>) &#123;<br>            e.value = v;<br>            afterNodeAccess(e);<br>            <span class="hljs-keyword">return</span> v;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>            removeNode(hash, key, <span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> V <span class="hljs-title function_">compute</span><span class="hljs-params">(K key,</span><br><span class="hljs-params">                 BiFunction&lt;? <span class="hljs-built_in">super</span> K, ? <span class="hljs-built_in">super</span> V, ? extends V&gt; remappingFunction)</span> &#123;<br>    <span class="hljs-keyword">if</span> (remappingFunction == <span class="hljs-literal">null</span>)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>    <span class="hljs-type">int</span> <span class="hljs-variable">hash</span> <span class="hljs-operator">=</span> hash(key);<br>    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first; <span class="hljs-type">int</span> n, i;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">binCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    TreeNode&lt;K,V&gt; t = <span class="hljs-literal">null</span>;<br>    Node&lt;K,V&gt; old = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">if</span> (size &gt; threshold || (tab = table) == <span class="hljs-literal">null</span> ||<br>        (n = tab.length) == <span class="hljs-number">0</span>)<br>        n = (tab = resize()).length;<br>    <span class="hljs-keyword">if</span> ((first = tab[i = (n - <span class="hljs-number">1</span>) &amp; hash]) != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">if</span> (first <span class="hljs-keyword">instanceof</span> TreeNode)<br>            old = (t = (TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);<br>        <span class="hljs-keyword">else</span> &#123;<br>            Node&lt;K,V&gt; e = first; K k;<br>            <span class="hljs-keyword">do</span> &#123;<br>                <span class="hljs-keyword">if</span> (e.hash == hash &amp;&amp;<br>                    ((k = e.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k)))) &#123;<br>                    old = e;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>                ++binCount;<br>            &#125; <span class="hljs-keyword">while</span> ((e = e.next) != <span class="hljs-literal">null</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-type">V</span> <span class="hljs-variable">oldValue</span> <span class="hljs-operator">=</span> (old == <span class="hljs-literal">null</span>) ? <span class="hljs-literal">null</span> : old.value;<br>    <span class="hljs-type">V</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> remappingFunction.apply(key, oldValue);<br>    <span class="hljs-keyword">if</span> (old != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">if</span> (v != <span class="hljs-literal">null</span>) &#123;<br>            old.value = v;<br>            afterNodeAccess(old);<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>            removeNode(hash, key, <span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (v != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">if</span> (t != <span class="hljs-literal">null</span>)<br>            t.putTreeVal(<span class="hljs-built_in">this</span>, tab, hash, key, v);<br>        <span class="hljs-keyword">else</span> &#123;<br>            tab[i] = newNode(hash, key, v, first);<br>            <span class="hljs-keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="hljs-number">1</span>)<br>                treeifyBin(tab, hash);<br>        &#125;<br>        ++modCount;<br>        ++size;<br>        afterNodeInsertion(<span class="hljs-literal">true</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> v;<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> V <span class="hljs-title function_">merge</span><span class="hljs-params">(K key, V value,</span><br><span class="hljs-params">               BiFunction&lt;? <span class="hljs-built_in">super</span> V, ? <span class="hljs-built_in">super</span> V, ? extends V&gt; remappingFunction)</span> &#123;<br>    <span class="hljs-keyword">if</span> (value == <span class="hljs-literal">null</span>)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>    <span class="hljs-keyword">if</span> (remappingFunction == <span class="hljs-literal">null</span>)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>    <span class="hljs-type">int</span> <span class="hljs-variable">hash</span> <span class="hljs-operator">=</span> hash(key);<br>    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first; <span class="hljs-type">int</span> n, i;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">binCount</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>    TreeNode&lt;K,V&gt; t = <span class="hljs-literal">null</span>;<br>    Node&lt;K,V&gt; old = <span class="hljs-literal">null</span>;<br>    <span class="hljs-keyword">if</span> (size &gt; threshold || (tab = table) == <span class="hljs-literal">null</span> ||<br>        (n = tab.length) == <span class="hljs-number">0</span>)<br>        n = (tab = resize()).length;<br>    <span class="hljs-keyword">if</span> ((first = tab[i = (n - <span class="hljs-number">1</span>) &amp; hash]) != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">if</span> (first <span class="hljs-keyword">instanceof</span> TreeNode)<br>            old = (t = (TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);<br>        <span class="hljs-keyword">else</span> &#123;<br>            Node&lt;K,V&gt; e = first; K k;<br>            <span class="hljs-keyword">do</span> &#123;<br>                <span class="hljs-keyword">if</span> (e.hash == hash &amp;&amp;<br>                    ((k = e.key) == key || (key != <span class="hljs-literal">null</span> &amp;&amp; key.equals(k)))) &#123;<br>                    old = e;<br>                    <span class="hljs-keyword">break</span>;<br>                &#125;<br>                ++binCount;<br>            &#125; <span class="hljs-keyword">while</span> ((e = e.next) != <span class="hljs-literal">null</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (old != <span class="hljs-literal">null</span>) &#123;<br>        V v;<br>        <span class="hljs-keyword">if</span> (old.value != <span class="hljs-literal">null</span>)<br>            v = remappingFunction.apply(old.value, value);<br>        <span class="hljs-keyword">else</span><br>            v = value;<br>        <span class="hljs-keyword">if</span> (v != <span class="hljs-literal">null</span>) &#123;<br>            old.value = v;<br>            afterNodeAccess(old);<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>            removeNode(hash, key, <span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>);<br>        <span class="hljs-keyword">return</span> v;<br>    &#125;<br>    <span class="hljs-keyword">if</span> (value != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">if</span> (t != <span class="hljs-literal">null</span>)<br>            t.putTreeVal(<span class="hljs-built_in">this</span>, tab, hash, key, value);<br>        <span class="hljs-keyword">else</span> &#123;<br>            tab[i] = newNode(hash, key, value, first);<br>            <span class="hljs-keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="hljs-number">1</span>)<br>                treeifyBin(tab, hash);<br>        &#125;<br>        ++modCount;<br>        ++size;<br>        afterNodeInsertion(<span class="hljs-literal">true</span>);<br>    &#125;<br>    <span class="hljs-keyword">return</span> value;<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEach</span><span class="hljs-params">(BiConsumer&lt;? <span class="hljs-built_in">super</span> K, ? <span class="hljs-built_in">super</span> V&gt; action)</span> &#123;<br>    Node&lt;K,V&gt;[] tab;<br>    <span class="hljs-keyword">if</span> (action == <span class="hljs-literal">null</span>)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>    <span class="hljs-keyword">if</span> (size &gt; <span class="hljs-number">0</span> &amp;&amp; (tab = table) != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">mc</span> <span class="hljs-operator">=</span> modCount;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; tab.length; ++i) &#123;<br>            <span class="hljs-keyword">for</span> (Node&lt;K,V&gt; e = tab[i]; e != <span class="hljs-literal">null</span>; e = e.next)<br>                action.accept(e.key, e.value);<br>        &#125;<br>        <span class="hljs-keyword">if</span> (modCount != mc)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">replaceAll</span><span class="hljs-params">(BiFunction&lt;? <span class="hljs-built_in">super</span> K, ? <span class="hljs-built_in">super</span> V, ? extends V&gt; function)</span> &#123;<br>    Node&lt;K,V&gt;[] tab;<br>    <span class="hljs-keyword">if</span> (function == <span class="hljs-literal">null</span>)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>    <span class="hljs-keyword">if</span> (size &gt; <span class="hljs-number">0</span> &amp;&amp; (tab = table) != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">mc</span> <span class="hljs-operator">=</span> modCount;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; tab.length; ++i) &#123;<br>            <span class="hljs-keyword">for</span> (Node&lt;K,V&gt; e = tab[i]; e != <span class="hljs-literal">null</span>; e = e.next) &#123;<br>                e.value = function.apply(e.key, e.value);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (modCount != mc)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/* ------------------------------------------------------------ */</span><br><span class="hljs-comment">// Cloning and serialization</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Returns a shallow copy of this &lt;tt&gt;HashMap&lt;/tt&gt; instance: the keys and</span><br><span class="hljs-comment"> * values themselves are not cloned.</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@return</span> a shallow copy of this map</span><br><span class="hljs-comment"> */</span><br><span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br><span class="hljs-meta">@Override</span><br><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">clone</span><span class="hljs-params">()</span> &#123;<br>    HashMap&lt;K,V&gt; result;<br>    <span class="hljs-keyword">try</span> &#123;<br>        result = (HashMap&lt;K,V&gt;)<span class="hljs-built_in">super</span>.clone();<br>    &#125; <span class="hljs-keyword">catch</span> (CloneNotSupportedException e) &#123;<br>        <span class="hljs-comment">// this shouldn&#x27;t happen, since we are Cloneable</span><br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InternalError</span>(e);<br>    &#125;<br>    result.reinitialize();<br>    result.putMapEntries(<span class="hljs-built_in">this</span>, <span class="hljs-literal">false</span>);<br>    <span class="hljs-keyword">return</span> result;<br>&#125;<br><br><span class="hljs-comment">// These methods are also used when serializing HashSets</span><br><span class="hljs-keyword">final</span> <span class="hljs-type">float</span> <span class="hljs-title function_">loadFactor</span><span class="hljs-params">()</span> &#123; <span class="hljs-keyword">return</span> loadFactor; &#125;<br><span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">capacity</span><span class="hljs-params">()</span> &#123;<br>    <span class="hljs-keyword">return</span> (table != <span class="hljs-literal">null</span>) ? table.length :<br>        (threshold &gt; <span class="hljs-number">0</span>) ? threshold :<br>        DEFAULT_INITIAL_CAPACITY;<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Save the state of the &lt;tt&gt;HashMap&lt;/tt&gt; instance to a stream (i.e.,</span><br><span class="hljs-comment"> * serialize it).</span><br><span class="hljs-comment"> *</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@serialData</span> The &lt;i&gt;capacity&lt;/i&gt; of the HashMap (the length of the</span><br><span class="hljs-comment"> *             bucket array) is emitted (int), followed by the</span><br><span class="hljs-comment"> *             &lt;i&gt;size&lt;/i&gt; (an int, the number of key-value</span><br><span class="hljs-comment"> *             mappings), followed by the key (Object) and value (Object)</span><br><span class="hljs-comment"> *             for each key-value mapping.  The key-value mappings are</span><br><span class="hljs-comment"> *             emitted in no particular order.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">writeObject</span><span class="hljs-params">(java.io.ObjectOutputStream s)</span><br>    <span class="hljs-keyword">throws</span> IOException &#123;<br>    <span class="hljs-type">int</span> <span class="hljs-variable">buckets</span> <span class="hljs-operator">=</span> capacity();<br>    <span class="hljs-comment">// Write out the threshold, loadfactor, and any hidden stuff</span><br>    s.defaultWriteObject();<br>    s.writeInt(buckets);<br>    s.writeInt(size);<br>    internalWriteEntries(s);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Reconstitute the &#123;<span class="hljs-doctag">@code</span> HashMap&#125; instance from a stream (i.e.,</span><br><span class="hljs-comment"> * deserialize it).</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readObject</span><span class="hljs-params">(java.io.ObjectInputStream s)</span><br>    <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>    <span class="hljs-comment">// Read in the threshold (ignored), loadfactor, and any hidden stuff</span><br>    s.defaultReadObject();<br>    reinitialize();<br>    <span class="hljs-keyword">if</span> (loadFactor &lt;= <span class="hljs-number">0</span> || Float.isNaN(loadFactor))<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvalidObjectException</span>(<span class="hljs-string">&quot;Illegal load factor: &quot;</span> +<br>                                         loadFactor);<br>    s.readInt();                <span class="hljs-comment">// Read and ignore number of buckets</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">mappings</span> <span class="hljs-operator">=</span> s.readInt(); <span class="hljs-comment">// Read number of mappings (size)</span><br>    <span class="hljs-keyword">if</span> (mappings &lt; <span class="hljs-number">0</span>)<br>        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvalidObjectException</span>(<span class="hljs-string">&quot;Illegal mappings count: &quot;</span> +<br>                                         mappings);<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (mappings &gt; <span class="hljs-number">0</span>) &#123; <span class="hljs-comment">// (if zero, use defaults)</span><br>        <span class="hljs-comment">// Size the table using given load factor only if within</span><br>        <span class="hljs-comment">// range of 0.25...4.0</span><br>        <span class="hljs-type">float</span> <span class="hljs-variable">lf</span> <span class="hljs-operator">=</span> Math.min(Math.max(<span class="hljs-number">0.25f</span>, loadFactor), <span class="hljs-number">4.0f</span>);<br>        <span class="hljs-type">float</span> <span class="hljs-variable">fc</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>)mappings / lf + <span class="hljs-number">1.0f</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">cap</span> <span class="hljs-operator">=</span> ((fc &lt; DEFAULT_INITIAL_CAPACITY) ?<br>                   DEFAULT_INITIAL_CAPACITY :<br>                   (fc &gt;= MAXIMUM_CAPACITY) ?<br>                   MAXIMUM_CAPACITY :<br>                   tableSizeFor((<span class="hljs-type">int</span>)fc));<br>        <span class="hljs-type">float</span> <span class="hljs-variable">ft</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>)cap * lf;<br>        threshold = ((cap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; MAXIMUM_CAPACITY) ?<br>                     (<span class="hljs-type">int</span>)ft : Integer.MAX_VALUE);<br>        <span class="hljs-meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span><br>            Node&lt;K,V&gt;[] tab = (Node&lt;K,V&gt;[])<span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>[cap];<br>        table = tab;<br><br>        <span class="hljs-comment">// Read the keys and values, and put the mappings in the HashMap</span><br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; mappings; i++) &#123;<br>            <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>                <span class="hljs-type">K</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> (K) s.readObject();<br>            <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>                <span class="hljs-type">V</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> (V) s.readObject();<br>            putVal(hash(key), key, value, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/* ------------------------------------------------------------ */</span><br><span class="hljs-comment">// iterators</span><br><br><span class="hljs-keyword">abstract</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HashIterator</span> &#123;<br>    Node&lt;K,V&gt; next;        <span class="hljs-comment">// next entry to return</span><br>    Node&lt;K,V&gt; current;     <span class="hljs-comment">// current entry</span><br>    <span class="hljs-type">int</span> expectedModCount;  <span class="hljs-comment">// for fast-fail</span><br>    <span class="hljs-type">int</span> index;             <span class="hljs-comment">// current slot</span><br><br>    HashIterator() &#123;<br>        expectedModCount = modCount;<br>        Node&lt;K,V&gt;[] t = table;<br>        current = next = <span class="hljs-literal">null</span>;<br>        index = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">if</span> (t != <span class="hljs-literal">null</span> &amp;&amp; size &gt; <span class="hljs-number">0</span>) &#123; <span class="hljs-comment">// advance to first entry</span><br>            <span class="hljs-keyword">do</span> &#123;&#125; <span class="hljs-keyword">while</span> (index &lt; t.length &amp;&amp; (next = t[index++]) == <span class="hljs-literal">null</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">hasNext</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> next != <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">final</span> Node&lt;K,V&gt; <span class="hljs-title function_">nextNode</span><span class="hljs-params">()</span> &#123;<br>        Node&lt;K,V&gt;[] t;<br>        Node&lt;K,V&gt; e = next;<br>        <span class="hljs-keyword">if</span> (modCount != expectedModCount)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>        <span class="hljs-keyword">if</span> (e == <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NoSuchElementException</span>();<br>        <span class="hljs-keyword">if</span> ((next = (current = e).next) == <span class="hljs-literal">null</span> &amp;&amp; (t = table) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">do</span> &#123;&#125; <span class="hljs-keyword">while</span> (index &lt; t.length &amp;&amp; (next = t[index++]) == <span class="hljs-literal">null</span>);<br>        &#125;<br>        <span class="hljs-keyword">return</span> e;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">remove</span><span class="hljs-params">()</span> &#123;<br>        Node&lt;K,V&gt; p = current;<br>        <span class="hljs-keyword">if</span> (p == <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">IllegalStateException</span>();<br>        <span class="hljs-keyword">if</span> (modCount != expectedModCount)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>        current = <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">K</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> p.key;<br>        removeNode(hash(key), key, <span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);<br>        expectedModCount = modCount;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">KeyIterator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HashIterator</span><br>    <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterator</span>&lt;K&gt; &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> K <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123; <span class="hljs-keyword">return</span> nextNode().key; &#125;<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ValueIterator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HashIterator</span><br>    <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterator</span>&lt;V&gt; &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> V <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123; <span class="hljs-keyword">return</span> nextNode().value; &#125;<br>&#125;<br><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntryIterator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HashIterator</span><br>    <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Iterator</span>&lt;Map.Entry&lt;K,V&gt;&gt; &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> Map.Entry&lt;K,V&gt; <span class="hljs-title function_">next</span><span class="hljs-params">()</span> &#123; <span class="hljs-keyword">return</span> nextNode(); &#125;<br>&#125;<br><br><span class="hljs-comment">/* ------------------------------------------------------------ */</span><br><span class="hljs-comment">// spliterators</span><br><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">HashMapSpliterator</span>&lt;K,V&gt; &#123;<br>    <span class="hljs-keyword">final</span> HashMap&lt;K,V&gt; map;<br>    Node&lt;K,V&gt; current;          <span class="hljs-comment">// current node</span><br>    <span class="hljs-type">int</span> index;                  <span class="hljs-comment">// current index, modified on advance/split</span><br>    <span class="hljs-type">int</span> fence;                  <span class="hljs-comment">// one past last index</span><br>    <span class="hljs-type">int</span> est;                    <span class="hljs-comment">// size estimate</span><br>    <span class="hljs-type">int</span> expectedModCount;       <span class="hljs-comment">// for comodification checks</span><br><br>    HashMapSpliterator(HashMap&lt;K,V&gt; m, <span class="hljs-type">int</span> origin,<br>                       <span class="hljs-type">int</span> fence, <span class="hljs-type">int</span> est,<br>                       <span class="hljs-type">int</span> expectedModCount) &#123;<br>        <span class="hljs-built_in">this</span>.map = m;<br>        <span class="hljs-built_in">this</span>.index = origin;<br>        <span class="hljs-built_in">this</span>.fence = fence;<br>        <span class="hljs-built_in">this</span>.est = est;<br>        <span class="hljs-built_in">this</span>.expectedModCount = expectedModCount;<br>    &#125;<br><br>    <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getFence</span><span class="hljs-params">()</span> &#123; <span class="hljs-comment">// initialize fence and size on first use</span><br>        <span class="hljs-type">int</span> hi;<br>        <span class="hljs-keyword">if</span> ((hi = fence) &lt; <span class="hljs-number">0</span>) &#123;<br>            HashMap&lt;K,V&gt; m = map;<br>            est = m.size;<br>            expectedModCount = m.modCount;<br>            Node&lt;K,V&gt;[] tab = m.table;<br>            hi = fence = (tab == <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : tab.length;<br>        &#125;<br>        <span class="hljs-keyword">return</span> hi;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-title function_">estimateSize</span><span class="hljs-params">()</span> &#123;<br>        getFence(); <span class="hljs-comment">// force init</span><br>        <span class="hljs-keyword">return</span> (<span class="hljs-type">long</span>) est;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">KeySpliterator</span>&lt;K,V&gt;<br>    <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HashMapSpliterator</span>&lt;K,V&gt;<br>    <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Spliterator</span>&lt;K&gt; &#123;<br>    KeySpliterator(HashMap&lt;K,V&gt; m, <span class="hljs-type">int</span> origin, <span class="hljs-type">int</span> fence, <span class="hljs-type">int</span> est,<br>                   <span class="hljs-type">int</span> expectedModCount) &#123;<br>        <span class="hljs-built_in">super</span>(m, origin, fence, est, expectedModCount);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> KeySpliterator&lt;K,V&gt; <span class="hljs-title function_">trySplit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">hi</span> <span class="hljs-operator">=</span> getFence(), lo = index, mid = (lo + hi) &gt;&gt;&gt; <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">return</span> (lo &gt;= mid || current != <span class="hljs-literal">null</span>) ? <span class="hljs-literal">null</span> :<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">KeySpliterator</span>&lt;&gt;(map, lo, index = mid, est &gt;&gt;&gt;= <span class="hljs-number">1</span>,<br>                                    expectedModCount);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEachRemaining</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> K&gt; action)</span> &#123;<br>        <span class="hljs-type">int</span> i, hi, mc;<br>        <span class="hljs-keyword">if</span> (action == <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>        HashMap&lt;K,V&gt; m = map;<br>        Node&lt;K,V&gt;[] tab = m.table;<br>        <span class="hljs-keyword">if</span> ((hi = fence) &lt; <span class="hljs-number">0</span>) &#123;<br>            mc = expectedModCount = m.modCount;<br>            hi = fence = (tab == <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : tab.length;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>            mc = expectedModCount;<br>        <span class="hljs-keyword">if</span> (tab != <span class="hljs-literal">null</span> &amp;&amp; tab.length &gt;= hi &amp;&amp;<br>            (i = index) &gt;= <span class="hljs-number">0</span> &amp;&amp; (i &lt; (index = hi) || current != <span class="hljs-literal">null</span>)) &#123;<br>            Node&lt;K,V&gt; p = current;<br>            current = <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">do</span> &#123;<br>                <span class="hljs-keyword">if</span> (p == <span class="hljs-literal">null</span>)<br>                    p = tab[i++];<br>                <span class="hljs-keyword">else</span> &#123;<br>                    action.accept(p.key);<br>                    p = p.next;<br>                &#125;<br>            &#125; <span class="hljs-keyword">while</span> (p != <span class="hljs-literal">null</span> || i &lt; hi);<br>            <span class="hljs-keyword">if</span> (m.modCount != mc)<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAdvance</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> K&gt; action)</span> &#123;<br>        <span class="hljs-type">int</span> hi;<br>        <span class="hljs-keyword">if</span> (action == <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>        Node&lt;K,V&gt;[] tab = map.table;<br>        <span class="hljs-keyword">if</span> (tab != <span class="hljs-literal">null</span> &amp;&amp; tab.length &gt;= (hi = getFence()) &amp;&amp; index &gt;= <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">while</span> (current != <span class="hljs-literal">null</span> || index &lt; hi) &#123;<br>                <span class="hljs-keyword">if</span> (current == <span class="hljs-literal">null</span>)<br>                    current = tab[index++];<br>                <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-type">K</span> <span class="hljs-variable">k</span> <span class="hljs-operator">=</span> current.key;<br>                    current = current.next;<br>                    action.accept(k);<br>                    <span class="hljs-keyword">if</span> (map.modCount != expectedModCount)<br>                        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">characteristics</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> (fence &lt; <span class="hljs-number">0</span> || est == map.size ? Spliterator.SIZED : <span class="hljs-number">0</span>) |<br>            Spliterator.DISTINCT;<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ValueSpliterator</span>&lt;K,V&gt;<br>    <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HashMapSpliterator</span>&lt;K,V&gt;<br>    <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Spliterator</span>&lt;V&gt; &#123;<br>    ValueSpliterator(HashMap&lt;K,V&gt; m, <span class="hljs-type">int</span> origin, <span class="hljs-type">int</span> fence, <span class="hljs-type">int</span> est,<br>                     <span class="hljs-type">int</span> expectedModCount) &#123;<br>        <span class="hljs-built_in">super</span>(m, origin, fence, est, expectedModCount);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> ValueSpliterator&lt;K,V&gt; <span class="hljs-title function_">trySplit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">hi</span> <span class="hljs-operator">=</span> getFence(), lo = index, mid = (lo + hi) &gt;&gt;&gt; <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">return</span> (lo &gt;= mid || current != <span class="hljs-literal">null</span>) ? <span class="hljs-literal">null</span> :<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">ValueSpliterator</span>&lt;&gt;(map, lo, index = mid, est &gt;&gt;&gt;= <span class="hljs-number">1</span>,<br>                                      expectedModCount);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEachRemaining</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> V&gt; action)</span> &#123;<br>        <span class="hljs-type">int</span> i, hi, mc;<br>        <span class="hljs-keyword">if</span> (action == <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>        HashMap&lt;K,V&gt; m = map;<br>        Node&lt;K,V&gt;[] tab = m.table;<br>        <span class="hljs-keyword">if</span> ((hi = fence) &lt; <span class="hljs-number">0</span>) &#123;<br>            mc = expectedModCount = m.modCount;<br>            hi = fence = (tab == <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : tab.length;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>            mc = expectedModCount;<br>        <span class="hljs-keyword">if</span> (tab != <span class="hljs-literal">null</span> &amp;&amp; tab.length &gt;= hi &amp;&amp;<br>            (i = index) &gt;= <span class="hljs-number">0</span> &amp;&amp; (i &lt; (index = hi) || current != <span class="hljs-literal">null</span>)) &#123;<br>            Node&lt;K,V&gt; p = current;<br>            current = <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">do</span> &#123;<br>                <span class="hljs-keyword">if</span> (p == <span class="hljs-literal">null</span>)<br>                    p = tab[i++];<br>                <span class="hljs-keyword">else</span> &#123;<br>                    action.accept(p.value);<br>                    p = p.next;<br>                &#125;<br>            &#125; <span class="hljs-keyword">while</span> (p != <span class="hljs-literal">null</span> || i &lt; hi);<br>            <span class="hljs-keyword">if</span> (m.modCount != mc)<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAdvance</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> V&gt; action)</span> &#123;<br>        <span class="hljs-type">int</span> hi;<br>        <span class="hljs-keyword">if</span> (action == <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>        Node&lt;K,V&gt;[] tab = map.table;<br>        <span class="hljs-keyword">if</span> (tab != <span class="hljs-literal">null</span> &amp;&amp; tab.length &gt;= (hi = getFence()) &amp;&amp; index &gt;= <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">while</span> (current != <span class="hljs-literal">null</span> || index &lt; hi) &#123;<br>                <span class="hljs-keyword">if</span> (current == <span class="hljs-literal">null</span>)<br>                    current = tab[index++];<br>                <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-type">V</span> <span class="hljs-variable">v</span> <span class="hljs-operator">=</span> current.value;<br>                    current = current.next;<br>                    action.accept(v);<br>                    <span class="hljs-keyword">if</span> (map.modCount != expectedModCount)<br>                        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">characteristics</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> (fence &lt; <span class="hljs-number">0</span> || est == map.size ? Spliterator.SIZED : <span class="hljs-number">0</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EntrySpliterator</span>&lt;K,V&gt;<br>    <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HashMapSpliterator</span>&lt;K,V&gt;<br>    <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Spliterator</span>&lt;Map.Entry&lt;K,V&gt;&gt; &#123;<br>    EntrySpliterator(HashMap&lt;K,V&gt; m, <span class="hljs-type">int</span> origin, <span class="hljs-type">int</span> fence, <span class="hljs-type">int</span> est,<br>                     <span class="hljs-type">int</span> expectedModCount) &#123;<br>        <span class="hljs-built_in">super</span>(m, origin, fence, est, expectedModCount);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> EntrySpliterator&lt;K,V&gt; <span class="hljs-title function_">trySplit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">hi</span> <span class="hljs-operator">=</span> getFence(), lo = index, mid = (lo + hi) &gt;&gt;&gt; <span class="hljs-number">1</span>;<br>        <span class="hljs-keyword">return</span> (lo &gt;= mid || current != <span class="hljs-literal">null</span>) ? <span class="hljs-literal">null</span> :<br>            <span class="hljs-keyword">new</span> <span class="hljs-title class_">EntrySpliterator</span>&lt;&gt;(map, lo, index = mid, est &gt;&gt;&gt;= <span class="hljs-number">1</span>,<br>                                      expectedModCount);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">forEachRemaining</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> Map.Entry&lt;K,V&gt;&gt; action)</span> &#123;<br>        <span class="hljs-type">int</span> i, hi, mc;<br>        <span class="hljs-keyword">if</span> (action == <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>        HashMap&lt;K,V&gt; m = map;<br>        Node&lt;K,V&gt;[] tab = m.table;<br>        <span class="hljs-keyword">if</span> ((hi = fence) &lt; <span class="hljs-number">0</span>) &#123;<br>            mc = expectedModCount = m.modCount;<br>            hi = fence = (tab == <span class="hljs-literal">null</span>) ? <span class="hljs-number">0</span> : tab.length;<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>            mc = expectedModCount;<br>        <span class="hljs-keyword">if</span> (tab != <span class="hljs-literal">null</span> &amp;&amp; tab.length &gt;= hi &amp;&amp;<br>            (i = index) &gt;= <span class="hljs-number">0</span> &amp;&amp; (i &lt; (index = hi) || current != <span class="hljs-literal">null</span>)) &#123;<br>            Node&lt;K,V&gt; p = current;<br>            current = <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">do</span> &#123;<br>                <span class="hljs-keyword">if</span> (p == <span class="hljs-literal">null</span>)<br>                    p = tab[i++];<br>                <span class="hljs-keyword">else</span> &#123;<br>                    action.accept(p);<br>                    p = p.next;<br>                &#125;<br>            &#125; <span class="hljs-keyword">while</span> (p != <span class="hljs-literal">null</span> || i &lt; hi);<br>            <span class="hljs-keyword">if</span> (m.modCount != mc)<br>                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">tryAdvance</span><span class="hljs-params">(Consumer&lt;? <span class="hljs-built_in">super</span> Map.Entry&lt;K,V&gt;&gt; action)</span> &#123;<br>        <span class="hljs-type">int</span> hi;<br>        <span class="hljs-keyword">if</span> (action == <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>        Node&lt;K,V&gt;[] tab = map.table;<br>        <span class="hljs-keyword">if</span> (tab != <span class="hljs-literal">null</span> &amp;&amp; tab.length &gt;= (hi = getFence()) &amp;&amp; index &gt;= <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-keyword">while</span> (current != <span class="hljs-literal">null</span> || index &lt; hi) &#123;<br>                <span class="hljs-keyword">if</span> (current == <span class="hljs-literal">null</span>)<br>                    current = tab[index++];<br>                <span class="hljs-keyword">else</span> &#123;<br>                    Node&lt;K,V&gt; e = current;<br>                    current = current.next;<br>                    action.accept(e);<br>                    <span class="hljs-keyword">if</span> (map.modCount != expectedModCount)<br>                        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConcurrentModificationException</span>();<br>                    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">characteristics</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> (fence &lt; <span class="hljs-number">0</span> || est == map.size ? Spliterator.SIZED : <span class="hljs-number">0</span>) |<br>            Spliterator.DISTINCT;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/* ------------------------------------------------------------ */</span><br><span class="hljs-comment">// LinkedHashMap support</span><br><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * The following package-protected methods are designed to be</span><br><span class="hljs-comment"> * overridden by LinkedHashMap, but not by any other subclass.</span><br><span class="hljs-comment"> * Nearly all other internal methods are also package-protected</span><br><span class="hljs-comment"> * but are declared final, so can be used by LinkedHashMap, view</span><br><span class="hljs-comment"> * classes, and HashSet.</span><br><span class="hljs-comment"> */</span><br><br><span class="hljs-comment">// Create a regular (non-tree) node</span><br>Node&lt;K,V&gt; <span class="hljs-title function_">newNode</span><span class="hljs-params">(<span class="hljs-type">int</span> hash, K key, V value, Node&lt;K,V&gt; next)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>&lt;&gt;(hash, key, value, next);<br>&#125;<br><br><span class="hljs-comment">// For conversion from TreeNodes to plain nodes</span><br>Node&lt;K,V&gt; <span class="hljs-title function_">replacementNode</span><span class="hljs-params">(Node&lt;K,V&gt; p, Node&lt;K,V&gt; next)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>&lt;&gt;(p.hash, p.key, p.value, next);<br>&#125;<br><br><span class="hljs-comment">// Create a tree bin node</span><br>TreeNode&lt;K,V&gt; <span class="hljs-title function_">newTreeNode</span><span class="hljs-params">(<span class="hljs-type">int</span> hash, K key, V value, Node&lt;K,V&gt; next)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>&lt;&gt;(hash, key, value, next);<br>&#125;<br><br><span class="hljs-comment">// For treeifyBin</span><br>TreeNode&lt;K,V&gt; <span class="hljs-title function_">replacementTreeNode</span><span class="hljs-params">(Node&lt;K,V&gt; p, Node&lt;K,V&gt; next)</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TreeNode</span>&lt;&gt;(p.hash, p.key, p.value, next);<br>&#125;<br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Reset to initial default state.  Called by clone and readObject.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">reinitialize</span><span class="hljs-params">()</span> &#123;<br>    table = <span class="hljs-literal">null</span>;<br>    entrySet = <span class="hljs-literal">null</span>;<br>    keySet = <span class="hljs-literal">null</span>;<br>    values = <span class="hljs-literal">null</span>;<br>    modCount = <span class="hljs-number">0</span>;<br>    threshold = <span class="hljs-number">0</span>;<br>    size = <span class="hljs-number">0</span>;<br>&#125;<br><br><span class="hljs-comment">// Callbacks to allow LinkedHashMap post-actions</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">afterNodeAccess</span><span class="hljs-params">(Node&lt;K,V&gt; p)</span> &#123; &#125;<br><span class="hljs-keyword">void</span> <span class="hljs-title function_">afterNodeInsertion</span><span class="hljs-params">(<span class="hljs-type">boolean</span> evict)</span> &#123; &#125;<br><span class="hljs-keyword">void</span> <span class="hljs-title function_">afterNodeRemoval</span><span class="hljs-params">(Node&lt;K,V&gt; p)</span> &#123; &#125;<br><br><span class="hljs-comment">// Called only from writeObject, to ensure compatible ordering.</span><br><span class="hljs-keyword">void</span> <span class="hljs-title function_">internalWriteEntries</span><span class="hljs-params">(java.io.ObjectOutputStream s)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>    Node&lt;K,V&gt;[] tab;<br>    <span class="hljs-keyword">if</span> (size &gt; <span class="hljs-number">0</span> &amp;&amp; (tab = table) != <span class="hljs-literal">null</span>) &#123;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; tab.length; ++i) &#123;<br>            <span class="hljs-keyword">for</span> (Node&lt;K,V&gt; e = tab[i]; e != <span class="hljs-literal">null</span>; e = e.next) &#123;<br>                s.writeObject(e.key);<br>                s.writeObject(e.value);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/* ------------------------------------------------------------ */</span><br><span class="hljs-comment">// Tree bins</span><br><br><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * Entry for Tree bins. Extends LinkedHashMap.Entry (which in turn</span><br><span class="hljs-comment"> * extends Node) so can be used as extension of either regular or</span><br><span class="hljs-comment"> * linked node.</span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TreeNode</span>&lt;K,V&gt; <span class="hljs-keyword">extends</span> <span class="hljs-title class_">LinkedHashMap</span>.Entry&lt;K,V&gt; &#123;<br>    TreeNode&lt;K,V&gt; parent;  <span class="hljs-comment">// red-black tree links</span><br>    TreeNode&lt;K,V&gt; left;<br>    TreeNode&lt;K,V&gt; right;<br>    TreeNode&lt;K,V&gt; prev;    <span class="hljs-comment">// needed to unlink next upon deletion</span><br>    <span class="hljs-type">boolean</span> red;<br>    TreeNode(<span class="hljs-type">int</span> hash, K key, V val, Node&lt;K,V&gt; next) &#123;<br>        <span class="hljs-built_in">super</span>(hash, key, val, next);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Returns root of tree containing this node.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">final</span> TreeNode&lt;K,V&gt; <span class="hljs-title function_">root</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">for</span> (TreeNode&lt;K,V&gt; r = <span class="hljs-built_in">this</span>, p;;) &#123;<br>            <span class="hljs-keyword">if</span> ((p = r.parent) == <span class="hljs-literal">null</span>)<br>                <span class="hljs-keyword">return</span> r;<br>            r = p;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Ensures that the given root is the first node of its bin.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">static</span> &lt;K,V&gt; <span class="hljs-keyword">void</span> <span class="hljs-title function_">moveRootToFront</span><span class="hljs-params">(Node&lt;K,V&gt;[] tab, TreeNode&lt;K,V&gt; root)</span> &#123;<br>        <span class="hljs-type">int</span> n;<br>        <span class="hljs-keyword">if</span> (root != <span class="hljs-literal">null</span> &amp;&amp; tab != <span class="hljs-literal">null</span> &amp;&amp; (n = tab.length) &gt; <span class="hljs-number">0</span>) &#123;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> (n - <span class="hljs-number">1</span>) &amp; root.hash;<br>            TreeNode&lt;K,V&gt; first = (TreeNode&lt;K,V&gt;)tab[index];<br>            <span class="hljs-keyword">if</span> (root != first) &#123;<br>                Node&lt;K,V&gt; rn;<br>                tab[index] = root;<br>                TreeNode&lt;K,V&gt; rp = root.prev;<br>                <span class="hljs-keyword">if</span> ((rn = root.next) != <span class="hljs-literal">null</span>)<br>                    ((TreeNode&lt;K,V&gt;)rn).prev = rp;<br>                <span class="hljs-keyword">if</span> (rp != <span class="hljs-literal">null</span>)<br>                    rp.next = rn;<br>                <span class="hljs-keyword">if</span> (first != <span class="hljs-literal">null</span>)<br>                    first.prev = root;<br>                root.next = first;<br>                root.prev = <span class="hljs-literal">null</span>;<br>            &#125;<br>            <span class="hljs-keyword">assert</span> <span class="hljs-title function_">checkInvariants</span><span class="hljs-params">(root)</span>;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Finds the node starting at root p with the given hash and key.</span><br><span class="hljs-comment">     * The kc argument caches comparableClassFor(key) upon first use</span><br><span class="hljs-comment">     * comparing keys.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">final</span> TreeNode&lt;K,V&gt; <span class="hljs-title function_">find</span><span class="hljs-params">(<span class="hljs-type">int</span> h, Object k, Class&lt;?&gt; kc)</span> &#123;<br>        TreeNode&lt;K,V&gt; p = <span class="hljs-built_in">this</span>;<br>        <span class="hljs-keyword">do</span> &#123;<br>            <span class="hljs-type">int</span> ph, dir; K pk;<br>            TreeNode&lt;K,V&gt; pl = p.left, pr = p.right, q;<br>            <span class="hljs-keyword">if</span> ((ph = p.hash) &gt; h)<br>                p = pl;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ph &lt; h)<br>                p = pr;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((pk = p.key) == k || (k != <span class="hljs-literal">null</span> &amp;&amp; k.equals(pk)))<br>                <span class="hljs-keyword">return</span> p;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pl == <span class="hljs-literal">null</span>)<br>                p = pr;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pr == <span class="hljs-literal">null</span>)<br>                p = pl;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((kc != <span class="hljs-literal">null</span> ||<br>                      (kc = comparableClassFor(k)) != <span class="hljs-literal">null</span>) &amp;&amp;<br>                     (dir = compareComparables(kc, k, pk)) != <span class="hljs-number">0</span>)<br>                p = (dir &lt; <span class="hljs-number">0</span>) ? pl : pr;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((q = pr.find(h, k, kc)) != <span class="hljs-literal">null</span>)<br>                <span class="hljs-keyword">return</span> q;<br>            <span class="hljs-keyword">else</span><br>                p = pl;<br>        &#125; <span class="hljs-keyword">while</span> (p != <span class="hljs-literal">null</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Calls find for root node.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">final</span> TreeNode&lt;K,V&gt; <span class="hljs-title function_">getTreeNode</span><span class="hljs-params">(<span class="hljs-type">int</span> h, Object k)</span> &#123;<br>        <span class="hljs-keyword">return</span> ((parent != <span class="hljs-literal">null</span>) ? root() : <span class="hljs-built_in">this</span>).find(h, k, <span class="hljs-literal">null</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Tie-breaking utility for ordering insertions when equal</span><br><span class="hljs-comment">     * hashCodes and non-comparable. We don&#x27;t require a total</span><br><span class="hljs-comment">     * order, just a consistent insertion rule to maintain</span><br><span class="hljs-comment">     * equivalence across rebalancings. Tie-breaking further than</span><br><span class="hljs-comment">     * necessary simplifies testing a bit.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">tieBreakOrder</span><span class="hljs-params">(Object a, Object b)</span> &#123;<br>        <span class="hljs-type">int</span> d;<br>        <span class="hljs-keyword">if</span> (a == <span class="hljs-literal">null</span> || b == <span class="hljs-literal">null</span> ||<br>            (d = a.getClass().getName().<br>             compareTo(b.getClass().getName())) == <span class="hljs-number">0</span>)<br>            d = (System.identityHashCode(a) &lt;= System.identityHashCode(b) ?<br>                 -<span class="hljs-number">1</span> : <span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">return</span> d;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Forms tree of the nodes linked from this node.</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> root of tree</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">treeify</span><span class="hljs-params">(Node&lt;K,V&gt;[] tab)</span> &#123;<br>        TreeNode&lt;K,V&gt; root = <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">for</span> (TreeNode&lt;K,V&gt; x = <span class="hljs-built_in">this</span>, next; x != <span class="hljs-literal">null</span>; x = next) &#123;<br>            next = (TreeNode&lt;K,V&gt;)x.next;<br>            x.left = x.right = <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span>) &#123;<br>                x.parent = <span class="hljs-literal">null</span>;<br>                x.red = <span class="hljs-literal">false</span>;<br>                root = x;<br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-type">K</span> <span class="hljs-variable">k</span> <span class="hljs-operator">=</span> x.key;<br>                <span class="hljs-type">int</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> x.hash;<br>                Class&lt;?&gt; kc = <span class="hljs-literal">null</span>;<br>                <span class="hljs-keyword">for</span> (TreeNode&lt;K,V&gt; p = root;;) &#123;<br>                    <span class="hljs-type">int</span> dir, ph;<br>                    <span class="hljs-type">K</span> <span class="hljs-variable">pk</span> <span class="hljs-operator">=</span> p.key;<br>                    <span class="hljs-keyword">if</span> ((ph = p.hash) &gt; h)<br>                        dir = -<span class="hljs-number">1</span>;<br>                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ph &lt; h)<br>                        dir = <span class="hljs-number">1</span>;<br>                    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((kc == <span class="hljs-literal">null</span> &amp;&amp;<br>                              (kc = comparableClassFor(k)) == <span class="hljs-literal">null</span>) ||<br>                             (dir = compareComparables(kc, k, pk)) == <span class="hljs-number">0</span>)<br>                        dir = tieBreakOrder(k, pk);<br><br>                    TreeNode&lt;K,V&gt; xp = p;<br>                    <span class="hljs-keyword">if</span> ((p = (dir &lt;= <span class="hljs-number">0</span>) ? p.left : p.right) == <span class="hljs-literal">null</span>) &#123;<br>                        x.parent = xp;<br>                        <span class="hljs-keyword">if</span> (dir &lt;= <span class="hljs-number">0</span>)<br>                            xp.left = x;<br>                        <span class="hljs-keyword">else</span><br>                            xp.right = x;<br>                        root = balanceInsertion(root, x);<br>                        <span class="hljs-keyword">break</span>;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>        moveRootToFront(tab, root);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Returns a list of non-TreeNodes replacing those linked from</span><br><span class="hljs-comment">     * this node.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">final</span> Node&lt;K,V&gt; <span class="hljs-title function_">untreeify</span><span class="hljs-params">(HashMap&lt;K,V&gt; map)</span> &#123;<br>        Node&lt;K,V&gt; hd = <span class="hljs-literal">null</span>, tl = <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">for</span> (Node&lt;K,V&gt; q = <span class="hljs-built_in">this</span>; q != <span class="hljs-literal">null</span>; q = q.next) &#123;<br>            Node&lt;K,V&gt; p = map.replacementNode(q, <span class="hljs-literal">null</span>);<br>            <span class="hljs-keyword">if</span> (tl == <span class="hljs-literal">null</span>)<br>                hd = p;<br>            <span class="hljs-keyword">else</span><br>                tl.next = p;<br>            tl = p;<br>        &#125;<br>        <span class="hljs-keyword">return</span> hd;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Tree version of putVal.</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">final</span> TreeNode&lt;K,V&gt; <span class="hljs-title function_">putTreeVal</span><span class="hljs-params">(HashMap&lt;K,V&gt; map, Node&lt;K,V&gt;[] tab,</span><br><span class="hljs-params">                                   <span class="hljs-type">int</span> h, K k, V v)</span> &#123;<br>        Class&lt;?&gt; kc = <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">boolean</span> <span class="hljs-variable">searched</span> <span class="hljs-operator">=</span> <span class="hljs-literal">false</span>;<br>        TreeNode&lt;K,V&gt; root = (parent != <span class="hljs-literal">null</span>) ? root() : <span class="hljs-built_in">this</span>;<br>        <span class="hljs-keyword">for</span> (TreeNode&lt;K,V&gt; p = root;;) &#123;<br>            <span class="hljs-type">int</span> dir, ph; K pk;<br>            <span class="hljs-keyword">if</span> ((ph = p.hash) &gt; h)<br>                dir = -<span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (ph &lt; h)<br>                dir = <span class="hljs-number">1</span>;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((pk = p.key) == k || (k != <span class="hljs-literal">null</span> &amp;&amp; k.equals(pk)))<br>                <span class="hljs-keyword">return</span> p;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((kc == <span class="hljs-literal">null</span> &amp;&amp;<br>                      (kc = comparableClassFor(k)) == <span class="hljs-literal">null</span>) ||<br>                     (dir = compareComparables(kc, k, pk)) == <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">if</span> (!searched) &#123;<br>                    TreeNode&lt;K,V&gt; q, ch;<br>                    searched = <span class="hljs-literal">true</span>;<br>                    <span class="hljs-keyword">if</span> (((ch = p.left) != <span class="hljs-literal">null</span> &amp;&amp;<br>                         (q = ch.find(h, k, kc)) != <span class="hljs-literal">null</span>) ||<br>                        ((ch = p.right) != <span class="hljs-literal">null</span> &amp;&amp;<br>                         (q = ch.find(h, k, kc)) != <span class="hljs-literal">null</span>))<br>                        <span class="hljs-keyword">return</span> q;<br>                &#125;<br>                dir = tieBreakOrder(k, pk);<br>            &#125;<br><br>            TreeNode&lt;K,V&gt; xp = p;<br>            <span class="hljs-keyword">if</span> ((p = (dir &lt;= <span class="hljs-number">0</span>) ? p.left : p.right) == <span class="hljs-literal">null</span>) &#123;<br>                Node&lt;K,V&gt; xpn = xp.next;<br>                TreeNode&lt;K,V&gt; x = map.newTreeNode(h, k, v, xpn);<br>                <span class="hljs-keyword">if</span> (dir &lt;= <span class="hljs-number">0</span>)<br>                    xp.left = x;<br>                <span class="hljs-keyword">else</span><br>                    xp.right = x;<br>                xp.next = x;<br>                x.parent = x.prev = xp;<br>                <span class="hljs-keyword">if</span> (xpn != <span class="hljs-literal">null</span>)<br>                    ((TreeNode&lt;K,V&gt;)xpn).prev = x;<br>                moveRootToFront(tab, balanceInsertion(root, x));<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Removes the given node, that must be present before this call.</span><br><span class="hljs-comment">     * This is messier than typical red-black deletion code because we</span><br><span class="hljs-comment">     * cannot swap the contents of an interior node with a leaf</span><br><span class="hljs-comment">     * successor that is pinned by &quot;next&quot; pointers that are accessible</span><br><span class="hljs-comment">     * independently during traversal. So instead we swap the tree</span><br><span class="hljs-comment">     * linkages. If the current tree appears to have too few nodes,</span><br><span class="hljs-comment">     * the bin is converted back to a plain bin. (The test triggers</span><br><span class="hljs-comment">     * somewhere between 2 and 6 nodes, depending on tree structure).</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">removeTreeNode</span><span class="hljs-params">(HashMap&lt;K,V&gt; map, Node&lt;K,V&gt;[] tab,</span><br><span class="hljs-params">                              <span class="hljs-type">boolean</span> movable)</span> &#123;<br>        <span class="hljs-type">int</span> n;<br>        <span class="hljs-keyword">if</span> (tab == <span class="hljs-literal">null</span> || (n = tab.length) == <span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">return</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">index</span> <span class="hljs-operator">=</span> (n - <span class="hljs-number">1</span>) &amp; hash;<br>        TreeNode&lt;K,V&gt; first = (TreeNode&lt;K,V&gt;)tab[index], root = first, rl;<br>        TreeNode&lt;K,V&gt; succ = (TreeNode&lt;K,V&gt;)next, pred = prev;<br>        <span class="hljs-keyword">if</span> (pred == <span class="hljs-literal">null</span>)<br>            tab[index] = first = succ;<br>        <span class="hljs-keyword">else</span><br>            pred.next = succ;<br>        <span class="hljs-keyword">if</span> (succ != <span class="hljs-literal">null</span>)<br>            succ.prev = pred;<br>        <span class="hljs-keyword">if</span> (first == <span class="hljs-literal">null</span>)<br>            <span class="hljs-keyword">return</span>;<br>        <span class="hljs-keyword">if</span> (root.parent != <span class="hljs-literal">null</span>)<br>            root = root.root();<br>        <span class="hljs-keyword">if</span> (root == <span class="hljs-literal">null</span> || root.right == <span class="hljs-literal">null</span> ||<br>            (rl = root.left) == <span class="hljs-literal">null</span> || rl.left == <span class="hljs-literal">null</span>) &#123;<br>            tab[index] = first.untreeify(map);  <span class="hljs-comment">// too small</span><br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        TreeNode&lt;K,V&gt; p = <span class="hljs-built_in">this</span>, pl = left, pr = right, replacement;<br>        <span class="hljs-keyword">if</span> (pl != <span class="hljs-literal">null</span> &amp;&amp; pr != <span class="hljs-literal">null</span>) &#123;<br>            TreeNode&lt;K,V&gt; s = pr, sl;<br>            <span class="hljs-keyword">while</span> ((sl = s.left) != <span class="hljs-literal">null</span>) <span class="hljs-comment">// find successor</span><br>                s = sl;<br>            <span class="hljs-type">boolean</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> s.red; s.red = p.red; p.red = c; <span class="hljs-comment">// swap colors</span><br>            TreeNode&lt;K,V&gt; sr = s.right;<br>            TreeNode&lt;K,V&gt; pp = p.parent;<br>            <span class="hljs-keyword">if</span> (s == pr) &#123; <span class="hljs-comment">// p was s&#x27;s direct parent</span><br>                p.parent = s;<br>                s.right = p;<br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123;<br>                TreeNode&lt;K,V&gt; sp = s.parent;<br>                <span class="hljs-keyword">if</span> ((p.parent = sp) != <span class="hljs-literal">null</span>) &#123;<br>                    <span class="hljs-keyword">if</span> (s == sp.left)<br>                        sp.left = p;<br>                    <span class="hljs-keyword">else</span><br>                        sp.right = p;<br>                &#125;<br>                <span class="hljs-keyword">if</span> ((s.right = pr) != <span class="hljs-literal">null</span>)<br>                    pr.parent = s;<br>            &#125;<br>            p.left = <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">if</span> ((p.right = sr) != <span class="hljs-literal">null</span>)<br>                sr.parent = p;<br>            <span class="hljs-keyword">if</span> ((s.left = pl) != <span class="hljs-literal">null</span>)<br>                pl.parent = s;<br>            <span class="hljs-keyword">if</span> ((s.parent = pp) == <span class="hljs-literal">null</span>)<br>                root = s;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (p == pp.left)<br>                pp.left = s;<br>            <span class="hljs-keyword">else</span><br>                pp.right = s;<br>            <span class="hljs-keyword">if</span> (sr != <span class="hljs-literal">null</span>)<br>                replacement = sr;<br>            <span class="hljs-keyword">else</span><br>                replacement = p;<br>        &#125;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pl != <span class="hljs-literal">null</span>)<br>            replacement = pl;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pr != <span class="hljs-literal">null</span>)<br>            replacement = pr;<br>        <span class="hljs-keyword">else</span><br>            replacement = p;<br>        <span class="hljs-keyword">if</span> (replacement != p) &#123;<br>            TreeNode&lt;K,V&gt; pp = replacement.parent = p.parent;<br>            <span class="hljs-keyword">if</span> (pp == <span class="hljs-literal">null</span>)<br>                root = replacement;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (p == pp.left)<br>                pp.left = replacement;<br>            <span class="hljs-keyword">else</span><br>                pp.right = replacement;<br>            p.left = p.right = p.parent = <span class="hljs-literal">null</span>;<br>        &#125;<br><br>        TreeNode&lt;K,V&gt; r = p.red ? root : balanceDeletion(root, replacement);<br><br>        <span class="hljs-keyword">if</span> (replacement == p) &#123;  <span class="hljs-comment">// detach</span><br>            TreeNode&lt;K,V&gt; pp = p.parent;<br>            p.parent = <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">if</span> (pp != <span class="hljs-literal">null</span>) &#123;<br>                <span class="hljs-keyword">if</span> (p == pp.left)<br>                    pp.left = <span class="hljs-literal">null</span>;<br>                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (p == pp.right)<br>                    pp.right = <span class="hljs-literal">null</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (movable)<br>            moveRootToFront(tab, r);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Splits nodes in a tree bin into lower and upper tree bins,</span><br><span class="hljs-comment">     * or untreeifies if now too small. Called only from resize;</span><br><span class="hljs-comment">     * see above discussion about split bits and indices.</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> map the map</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> tab the table for recording bin heads</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> index the index of the table being split</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> bit the bit of hash to split on</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">split</span><span class="hljs-params">(HashMap&lt;K,V&gt; map, Node&lt;K,V&gt;[] tab, <span class="hljs-type">int</span> index, <span class="hljs-type">int</span> bit)</span> &#123;<br>        TreeNode&lt;K,V&gt; b = <span class="hljs-built_in">this</span>;<br>        <span class="hljs-comment">// Relink into lo and hi lists, preserving order</span><br>        TreeNode&lt;K,V&gt; loHead = <span class="hljs-literal">null</span>, loTail = <span class="hljs-literal">null</span>;<br>        TreeNode&lt;K,V&gt; hiHead = <span class="hljs-literal">null</span>, hiTail = <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">int</span> <span class="hljs-variable">lc</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>, hc = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (TreeNode&lt;K,V&gt; e = b, next; e != <span class="hljs-literal">null</span>; e = next) &#123;<br>            next = (TreeNode&lt;K,V&gt;)e.next;<br>            e.next = <span class="hljs-literal">null</span>;<br>            <span class="hljs-keyword">if</span> ((e.hash &amp; bit) == <span class="hljs-number">0</span>) &#123;<br>                <span class="hljs-keyword">if</span> ((e.prev = loTail) == <span class="hljs-literal">null</span>)<br>                    loHead = e;<br>                <span class="hljs-keyword">else</span><br>                    loTail.next = e;<br>                loTail = e;<br>                ++lc;<br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">if</span> ((e.prev = hiTail) == <span class="hljs-literal">null</span>)<br>                    hiHead = e;<br>                <span class="hljs-keyword">else</span><br>                    hiTail.next = e;<br>                hiTail = e;<br>                ++hc;<br>            &#125;<br>        &#125;<br><br>        <span class="hljs-keyword">if</span> (loHead != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">if</span> (lc &lt;= UNTREEIFY_THRESHOLD)<br>                tab[index] = loHead.untreeify(map);<br>            <span class="hljs-keyword">else</span> &#123;<br>                tab[index] = loHead;<br>                <span class="hljs-keyword">if</span> (hiHead != <span class="hljs-literal">null</span>) <span class="hljs-comment">// (else is already treeified)</span><br>                    loHead.treeify(tab);<br>            &#125;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (hiHead != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">if</span> (hc &lt;= UNTREEIFY_THRESHOLD)<br>                tab[index + bit] = hiHead.untreeify(map);<br>            <span class="hljs-keyword">else</span> &#123;<br>                tab[index + bit] = hiHead;<br>                <span class="hljs-keyword">if</span> (loHead != <span class="hljs-literal">null</span>)<br>                    hiHead.treeify(tab);<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/* ------------------------------------------------------------ */</span><br>    <span class="hljs-comment">// Red-black tree methods, all adapted from CLR</span><br><br>    <span class="hljs-keyword">static</span> &lt;K,V&gt; TreeNode&lt;K,V&gt; <span class="hljs-title function_">rotateLeft</span><span class="hljs-params">(TreeNode&lt;K,V&gt; root,</span><br><span class="hljs-params">                                          TreeNode&lt;K,V&gt; p)</span> &#123;<br>        TreeNode&lt;K,V&gt; r, pp, rl;<br>        <span class="hljs-keyword">if</span> (p != <span class="hljs-literal">null</span> &amp;&amp; (r = p.right) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">if</span> ((rl = p.right = r.left) != <span class="hljs-literal">null</span>)<br>                rl.parent = p;<br>            <span class="hljs-keyword">if</span> ((pp = r.parent = p.parent) == <span class="hljs-literal">null</span>)<br>                (root = r).red = <span class="hljs-literal">false</span>;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pp.left == p)<br>                pp.left = r;<br>            <span class="hljs-keyword">else</span><br>                pp.right = r;<br>            r.left = p;<br>            p.parent = r;<br>        &#125;<br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;K,V&gt; TreeNode&lt;K,V&gt; <span class="hljs-title function_">rotateRight</span><span class="hljs-params">(TreeNode&lt;K,V&gt; root,</span><br><span class="hljs-params">                                           TreeNode&lt;K,V&gt; p)</span> &#123;<br>        TreeNode&lt;K,V&gt; l, pp, lr;<br>        <span class="hljs-keyword">if</span> (p != <span class="hljs-literal">null</span> &amp;&amp; (l = p.left) != <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">if</span> ((lr = p.left = l.right) != <span class="hljs-literal">null</span>)<br>                lr.parent = p;<br>            <span class="hljs-keyword">if</span> ((pp = l.parent = p.parent) == <span class="hljs-literal">null</span>)<br>                (root = l).red = <span class="hljs-literal">false</span>;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pp.right == p)<br>                pp.right = l;<br>            <span class="hljs-keyword">else</span><br>                pp.left = l;<br>            l.right = p;<br>            p.parent = l;<br>        &#125;<br>        <span class="hljs-keyword">return</span> root;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;K,V&gt; TreeNode&lt;K,V&gt; <span class="hljs-title function_">balanceInsertion</span><span class="hljs-params">(TreeNode&lt;K,V&gt; root,</span><br><span class="hljs-params">                                                TreeNode&lt;K,V&gt; x)</span> &#123;<br>        x.red = <span class="hljs-literal">true</span>;<br>        <span class="hljs-keyword">for</span> (TreeNode&lt;K,V&gt; xp, xpp, xppl, xppr;;) &#123;<br>            <span class="hljs-keyword">if</span> ((xp = x.parent) == <span class="hljs-literal">null</span>) &#123;<br>                x.red = <span class="hljs-literal">false</span>;<br>                <span class="hljs-keyword">return</span> x;<br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!xp.red || (xpp = xp.parent) == <span class="hljs-literal">null</span>)<br>                <span class="hljs-keyword">return</span> root;<br>            <span class="hljs-keyword">if</span> (xp == (xppl = xpp.left)) &#123;<br>                <span class="hljs-keyword">if</span> ((xppr = xpp.right) != <span class="hljs-literal">null</span> &amp;&amp; xppr.red) &#123;<br>                    xppr.red = <span class="hljs-literal">false</span>;<br>                    xp.red = <span class="hljs-literal">false</span>;<br>                    xpp.red = <span class="hljs-literal">true</span>;<br>                    x = xpp;<br>                &#125;<br>                <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">if</span> (x == xp.right) &#123;<br>                        root = rotateLeft(root, x = xp);<br>                        xpp = (xp = x.parent) == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : xp.parent;<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> (xp != <span class="hljs-literal">null</span>) &#123;<br>                        xp.red = <span class="hljs-literal">false</span>;<br>                        <span class="hljs-keyword">if</span> (xpp != <span class="hljs-literal">null</span>) &#123;<br>                            xpp.red = <span class="hljs-literal">true</span>;<br>                            root = rotateRight(root, xpp);<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">if</span> (xppl != <span class="hljs-literal">null</span> &amp;&amp; xppl.red) &#123;<br>                    xppl.red = <span class="hljs-literal">false</span>;<br>                    xp.red = <span class="hljs-literal">false</span>;<br>                    xpp.red = <span class="hljs-literal">true</span>;<br>                    x = xpp;<br>                &#125;<br>                <span class="hljs-keyword">else</span> &#123;<br>                    <span class="hljs-keyword">if</span> (x == xp.left) &#123;<br>                        root = rotateRight(root, x = xp);<br>                        xpp = (xp = x.parent) == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : xp.parent;<br>                    &#125;<br>                    <span class="hljs-keyword">if</span> (xp != <span class="hljs-literal">null</span>) &#123;<br>                        xp.red = <span class="hljs-literal">false</span>;<br>                        <span class="hljs-keyword">if</span> (xpp != <span class="hljs-literal">null</span>) &#123;<br>                            xpp.red = <span class="hljs-literal">true</span>;<br>                            root = rotateLeft(root, xpp);<br>                        &#125;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">static</span> &lt;K,V&gt; TreeNode&lt;K,V&gt; <span class="hljs-title function_">balanceDeletion</span><span class="hljs-params">(TreeNode&lt;K,V&gt; root,</span><br><span class="hljs-params">                                               TreeNode&lt;K,V&gt; x)</span> &#123;<br>        <span class="hljs-keyword">for</span> (TreeNode&lt;K,V&gt; xp, xpl, xpr;;)  &#123;<br>            <span class="hljs-keyword">if</span> (x == <span class="hljs-literal">null</span> || x == root)<br>                <span class="hljs-keyword">return</span> root;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((xp = x.parent) == <span class="hljs-literal">null</span>) &#123;<br>                x.red = <span class="hljs-literal">false</span>;<br>                <span class="hljs-keyword">return</span> x;<br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x.red) &#123;<br>                x.red = <span class="hljs-literal">false</span>;<br>                <span class="hljs-keyword">return</span> root;<br>            &#125;<br>            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((xpl = xp.left) == x) &#123;<br>                <span class="hljs-keyword">if</span> ((xpr = xp.right) != <span class="hljs-literal">null</span> &amp;&amp; xpr.red) &#123;<br>                    xpr.red = <span class="hljs-literal">false</span>;<br>                    xp.red = <span class="hljs-literal">true</span>;<br>                    root = rotateLeft(root, xp);<br>                    xpr = (xp = x.parent) == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : xp.right;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (xpr == <span class="hljs-literal">null</span>)<br>                    x = xp;<br>                <span class="hljs-keyword">else</span> &#123;<br>                    TreeNode&lt;K,V&gt; sl = xpr.left, sr = xpr.right;<br>                    <span class="hljs-keyword">if</span> ((sr == <span class="hljs-literal">null</span> || !sr.red) &amp;&amp;<br>                        (sl == <span class="hljs-literal">null</span> || !sl.red)) &#123;<br>                        xpr.red = <span class="hljs-literal">true</span>;<br>                        x = xp;<br>                    &#125;<br>                    <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-keyword">if</span> (sr == <span class="hljs-literal">null</span> || !sr.red) &#123;<br>                            <span class="hljs-keyword">if</span> (sl != <span class="hljs-literal">null</span>)<br>                                sl.red = <span class="hljs-literal">false</span>;<br>                            xpr.red = <span class="hljs-literal">true</span>;<br>                            root = rotateRight(root, xpr);<br>                            xpr = (xp = x.parent) == <span class="hljs-literal">null</span> ?<br>                                <span class="hljs-literal">null</span> : xp.right;<br>                        &#125;<br>                        <span class="hljs-keyword">if</span> (xpr != <span class="hljs-literal">null</span>) &#123;<br>                            xpr.red = (xp == <span class="hljs-literal">null</span>) ? <span class="hljs-literal">false</span> : xp.red;<br>                            <span class="hljs-keyword">if</span> ((sr = xpr.right) != <span class="hljs-literal">null</span>)<br>                                sr.red = <span class="hljs-literal">false</span>;<br>                        &#125;<br>                        <span class="hljs-keyword">if</span> (xp != <span class="hljs-literal">null</span>) &#123;<br>                            xp.red = <span class="hljs-literal">false</span>;<br>                            root = rotateLeft(root, xp);<br>                        &#125;<br>                        x = root;<br>                    &#125;<br>                &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">// symmetric</span><br>                <span class="hljs-keyword">if</span> (xpl != <span class="hljs-literal">null</span> &amp;&amp; xpl.red) &#123;<br>                    xpl.red = <span class="hljs-literal">false</span>;<br>                    xp.red = <span class="hljs-literal">true</span>;<br>                    root = rotateRight(root, xp);<br>                    xpl = (xp = x.parent) == <span class="hljs-literal">null</span> ? <span class="hljs-literal">null</span> : xp.left;<br>                &#125;<br>                <span class="hljs-keyword">if</span> (xpl == <span class="hljs-literal">null</span>)<br>                    x = xp;<br>                <span class="hljs-keyword">else</span> &#123;<br>                    TreeNode&lt;K,V&gt; sl = xpl.left, sr = xpl.right;<br>                    <span class="hljs-keyword">if</span> ((sl == <span class="hljs-literal">null</span> || !sl.red) &amp;&amp;<br>                        (sr == <span class="hljs-literal">null</span> || !sr.red)) &#123;<br>                        xpl.red = <span class="hljs-literal">true</span>;<br>                        x = xp;<br>                    &#125;<br>                    <span class="hljs-keyword">else</span> &#123;<br>                        <span class="hljs-keyword">if</span> (sl == <span class="hljs-literal">null</span> || !sl.red) &#123;<br>                            <span class="hljs-keyword">if</span> (sr != <span class="hljs-literal">null</span>)<br>                                sr.red = <span class="hljs-literal">false</span>;<br>                            xpl.red = <span class="hljs-literal">true</span>;<br>                            root = rotateLeft(root, xpl);<br>                            xpl = (xp = x.parent) == <span class="hljs-literal">null</span> ?<br>                                <span class="hljs-literal">null</span> : xp.left;<br>                        &#125;<br>                        <span class="hljs-keyword">if</span> (xpl != <span class="hljs-literal">null</span>) &#123;<br>                            xpl.red = (xp == <span class="hljs-literal">null</span>) ? <span class="hljs-literal">false</span> : xp.red;<br>                            <span class="hljs-keyword">if</span> ((sl = xpl.left) != <span class="hljs-literal">null</span>)<br>                                sl.red = <span class="hljs-literal">false</span>;<br>                        &#125;<br>                        <span class="hljs-keyword">if</span> (xp != <span class="hljs-literal">null</span>) &#123;<br>                            xp.red = <span class="hljs-literal">false</span>;<br>                            root = rotateRight(root, xp);<br>                        &#125;<br>                        x = root;<br>                    &#125;<br>                &#125;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * Recursive invariant check</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">static</span> &lt;K,V&gt; <span class="hljs-type">boolean</span> <span class="hljs-title function_">checkInvariants</span><span class="hljs-params">(TreeNode&lt;K,V&gt; t)</span> &#123;<br>        TreeNode&lt;K,V&gt; tp = t.parent, tl = t.left, tr = t.right,<br>            tb = t.prev, tn = (TreeNode&lt;K,V&gt;)t.next;<br>        <span class="hljs-keyword">if</span> (tb != <span class="hljs-literal">null</span> &amp;&amp; tb.next != t)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">if</span> (tn != <span class="hljs-literal">null</span> &amp;&amp; tn.prev != t)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">if</span> (tp != <span class="hljs-literal">null</span> &amp;&amp; t != tp.left &amp;&amp; t != tp.right)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">if</span> (tl != <span class="hljs-literal">null</span> &amp;&amp; (tl.parent != t || tl.hash &gt; t.hash))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">if</span> (tr != <span class="hljs-literal">null</span> &amp;&amp; (tr.parent != t || tr.hash &lt; t.hash))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">if</span> (t.red &amp;&amp; tl != <span class="hljs-literal">null</span> &amp;&amp; tl.red &amp;&amp; tr != <span class="hljs-literal">null</span> &amp;&amp; tr.red)<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">if</span> (tl != <span class="hljs-literal">null</span> &amp;&amp; !checkInvariants(tl))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">if</span> (tr != <span class="hljs-literal">null</span> &amp;&amp; !checkInvariants(tr))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>












<p>单链表长度大于8时会变成红黑树, 红黑树的长度小于6时, 又会变成单链表</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Java/" class="category-chain-item">Java</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Java/">#Java</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>HashMap源码</div>
      <div>https://xiamu.icu/Java/HashMap源码/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>肉豆蔻吖</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年12月18日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/Java/React%20Tutorial%20for%20Beginners/" title="React Tutorial for Beginners">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">React Tutorial for Beginners</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/Java/Java%E9%9D%A2%E8%AF%95%E9%A2%98/" title="Java面试题">
                        <span class="hidden-mobile">Java面试题</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"Haq24NRgHl4QheEi7oVqtAsM-gzGzoHsz","appKey":"kGbxzGaSiqqlFPxg24Tk3dVN","path":"window.location.pathname","placeholder":"来都来了, 不留下点啥吗?","avatar":"retro","meta":["nick","mail","link"],"requiredFields":["nick","mail"],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":true,"serverURLs":"","emojiCDN":"https://valinecdn.bili33.top","emojiMaps":{"Tieba-New2":"/Tieba-New/image_emoticon.png","Tieba-New3":"/Tieba-New/image_emoticon10.png","Tieba-New4":"/Tieba-New/image_emoticon100.png","Tieba-New5":"/Tieba-New/image_emoticon101.png","Tieba-New6":"/Tieba-New/image_emoticon102.png","Tieba-New7":"/Tieba-New/image_emoticon103.png","Tieba-New8":"/Tieba-New/image_emoticon104.png","Tieba-New9":"/Tieba-New/image_emoticon105.png","Tieba-New10":"/Tieba-New/image_emoticon106.png","Tieba-New11":"/Tieba-New/image_emoticon107.png","Tieba-New12":"/Tieba-New/image_emoticon108.png","Tieba-New13":"/Tieba-New/image_emoticon109.png","Tieba-New14":"/Tieba-New/image_emoticon11.png","Tieba-New15":"/Tieba-New/image_emoticon110.png","Tieba-New16":"/Tieba-New/image_emoticon111.png","Tieba-New17":"/Tieba-New/image_emoticon112.png","Tieba-New18":"/Tieba-New/image_emoticon113.png","Tieba-New19":"/Tieba-New/image_emoticon114.png","Tieba-New20":"/Tieba-New/image_emoticon115.png","Tieba-New21":"/Tieba-New/image_emoticon116.png","Tieba-New22":"/Tieba-New/image_emoticon117.png","Tieba-New23":"/Tieba-New/image_emoticon118.png","Tieba-New24":"/Tieba-New/image_emoticon119.png","Tieba-New25":"/Tieba-New/image_emoticon12.png","Tieba-New26":"/Tieba-New/image_emoticon120.png","Tieba-New27":"/Tieba-New/image_emoticon121.png","Tieba-New28":"/Tieba-New/image_emoticon122.png","Tieba-New29":"/Tieba-New/image_emoticon123.png","Tieba-New30":"/Tieba-New/image_emoticon124.png","Tieba-New31":"/Tieba-New/image_emoticon13.png","Tieba-New32":"/Tieba-New/image_emoticon14.png","Tieba-New33":"/Tieba-New/image_emoticon15.png","Tieba-New34":"/Tieba-New/image_emoticon16.png","Tieba-New35":"/Tieba-New/image_emoticon17.png","Tieba-New36":"/Tieba-New/image_emoticon18.png","Tieba-New37":"/Tieba-New/image_emoticon19.png","Tieba-New38":"/Tieba-New/image_emoticon2.png","Tieba-New39":"/Tieba-New/image_emoticon20.png","Tieba-New40":"/Tieba-New/image_emoticon21.png","Tieba-New41":"/Tieba-New/image_emoticon22.png","Tieba-New42":"/Tieba-New/image_emoticon23.png","Tieba-New43":"/Tieba-New/image_emoticon24.png","Tieba-New44":"/Tieba-New/image_emoticon25.png","Tieba-New45":"/Tieba-New/image_emoticon26.png","Tieba-New46":"/Tieba-New/image_emoticon27.png","Tieba-New47":"/Tieba-New/image_emoticon28.png","Tieba-New48":"/Tieba-New/image_emoticon29.png","Tieba-New49":"/Tieba-New/image_emoticon3.png","Tieba-New50":"/Tieba-New/image_emoticon30.png","Tieba-New51":"/Tieba-New/image_emoticon31.png","Tieba-New52":"/Tieba-New/image_emoticon32.png","Tieba-New53":"/Tieba-New/image_emoticon33.png","Tieba-New54":"/Tieba-New/image_emoticon34.png","Tieba-New55":"/Tieba-New/image_emoticon35.png","Tieba-New56":"/Tieba-New/image_emoticon36.png","Tieba-New57":"/Tieba-New/image_emoticon37.png","Tieba-New58":"/Tieba-New/image_emoticon38.png","Tieba-New59":"/Tieba-New/image_emoticon39.png","Tieba-New60":"/Tieba-New/image_emoticon4.png","Tieba-New61":"/Tieba-New/image_emoticon40.png","Tieba-New62":"/Tieba-New/image_emoticon41.png","Tieba-New63":"/Tieba-New/image_emoticon42.png","Tieba-New64":"/Tieba-New/image_emoticon43.png","Tieba-New65":"/Tieba-New/image_emoticon44.png","Tieba-New66":"/Tieba-New/image_emoticon45.png","Tieba-New67":"/Tieba-New/image_emoticon46.png","Tieba-New68":"/Tieba-New/image_emoticon47.png","Tieba-New69":"/Tieba-New/image_emoticon48.png","Tieba-New70":"/Tieba-New/image_emoticon49.png","Tieba-New71":"/Tieba-New/image_emoticon5.png","Tieba-New72":"/Tieba-New/image_emoticon50.png","Tieba-New73":"/Tieba-New/image_emoticon6.png","Tieba-New74":"/Tieba-New/image_emoticon66.png","Tieba-New75":"/Tieba-New/image_emoticon67.png","Tieba-New76":"/Tieba-New/image_emoticon68.png","Tieba-New77":"/Tieba-New/image_emoticon69.png","Tieba-New78":"/Tieba-New/image_emoticon7.png","Tieba-New79":"/Tieba-New/image_emoticon70.png","Tieba-New80":"/Tieba-New/image_emoticon71.png","Tieba-New81":"/Tieba-New/image_emoticon72.png","Tieba-New82":"/Tieba-New/image_emoticon73.png","Tieba-New83":"/Tieba-New/image_emoticon74.png","Tieba-New84":"/Tieba-New/image_emoticon75.png","Tieba-New85":"/Tieba-New/image_emoticon76.png","Tieba-New86":"/Tieba-New/image_emoticon77.png","Tieba-New87":"/Tieba-New/image_emoticon78.png","Tieba-New88":"/Tieba-New/image_emoticon79.png","Tieba-New89":"/Tieba-New/image_emoticon8.png","Tieba-New90":"/Tieba-New/image_emoticon80.png","Tieba-New91":"/Tieba-New/image_emoticon81.png","Tieba-New92":"/Tieba-New/image_emoticon82.png","Tieba-New93":"/Tieba-New/image_emoticon83.png","Tieba-New94":"/Tieba-New/image_emoticon84.png","Tieba-New95":"/Tieba-New/image_emoticon85.png","Tieba-New96":"/Tieba-New/image_emoticon86.png","Tieba-New97":"/Tieba-New/image_emoticon87.png","Tieba-New98":"/Tieba-New/image_emoticon88.png","Tieba-New99":"/Tieba-New/image_emoticon89.png","Tieba-New100":"/Tieba-New/image_emoticon9.png","Tieba-New101":"/Tieba-New/image_emoticon90.png","Tieba-New102":"/Tieba-New/image_emoticon91.png","Tieba-New103":"/Tieba-New/image_emoticon92.png","Tieba-New104":"/Tieba-New/image_emoticon93.png","Tieba-New105":"/Tieba-New/image_emoticon94.png","Tieba-New106":"/Tieba-New/image_emoticon95.png","Tieba-New107":"/Tieba-New/image_emoticon96.png","Tieba-New108":"/Tieba-New/image_emoticon97.png","Tieba-New109":"/Tieba-New/image_emoticon98.png","Tieba-New110":"/Tieba-New/image_emoticon99.png"},"enableQQ":true},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
    <!-- 备案信息 ICP for China -->
    <div class="beian">
  <span>
    <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
      湘ICP备2021007554号-1
    </a>
  </span>
  
</div>

  
  
</div>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">
    <script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/meting@1.2.0/dist/Meting.min.js"></script>
  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




  
<script src="/js/custom.js"></script>
<script src="/js/sakura.js"></script>



<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <!-- 全局配置aplayer播放器 -->
  <div class="aplayer" 
    data-id="5237049130" 
    data-server="netease"   
    data-type="playlist" 
    data-fixed="true" 
    data-autoplay="false" 
    data-order="list" 
    data-volume="0.5" 
    data-theme="#1da496" 
    data-preload="auto"
    >
  </div>

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
